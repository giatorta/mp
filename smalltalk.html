<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Metaprogramming in Smalltalk</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="MarcoNaddeo.tex"> 
<meta name="date" content="2015-06-18 16:21:00"> 
<link rel="stylesheet" type="text/css" href="smalltalk.css"> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
 <h2 class="titleHead">Metaprogramming in Smalltalk</h2>
<div class="author" ><span 
class="ecrm-1200">Marco Naddeo, PhD Candidate</span>
<br />  <span 
class="ecrm-1200">Universit</span><span 
class="ecrm-1200">à degli Studi di Torino</span>
<br />  </div><br />
<div class="date" ><span 
class="ecrm-1200">June 19, 2015</span></div>
   </div>                                                                 

                                                                  


   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Introduction</h3>
<!--l. 55--><p class="noindent" >The goal of this essay is to introduce the meta-programming features of the Smalltalk
language. In particular, we will focus on Pharo &#x00A0;<span class="cite">[<a 
href="#XBlac09a">1</a>]</span>, an open source implementation
of the Smalltalk programming language and environment. Pharo is a pure
object-oriented programming language and a powerful environment, focused on
simplicity and immediate feedback (think IDE and OS rolled into one). You can
download the latest version from <a 
href="http://pharo.org/download" class="url" target="_tab"><span 
class="cmtt-10">http://pharo.org/download</span></a>.
<!--l. 57--><br/>   This essay is organized as follows: firstly, Section <a 
href="#x1-20001">1<!--tex4ht:ref: sec:smalltalkobjmodel --></a> will briefly introduce the
Smalltalk object model, knowledge of which is essential for understanding the
hereinafter (if you are already familiar with Smalltalk, you can probably skip this
section); then, Section <a 
href="#x1-130002">2<!--tex4ht:ref: sec:metaprogramming --></a> will go into the details of the meta-programming features of
Pharo.
<!--l. 61--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>The Smalltalk object model</h3>
<!--l. 63--><p class="noindent" >Smalltalk&#8217;s programming model is simple and uniform: everything is an object, and
objects communicate only by sending each other messages. In fact, the Smalltalk
object model is based on a set of simple rules that are applied <span 
class="cmti-10">uniformly</span>. The rules
are the following:
                                                                  

                                                                  
<!--l. 65--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-30001"></a><span 
class="cmbx-10">Everything is an object.</span></span>
   Primitive entities like integers are objects, but also classes are first-class objects.
This means that you can send messages to integers and classes, for example: Pharo is
a truly reflective system, which gives a great deal of expressive power to
developers.
<!--l. 67--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-40001"></a><span 
class="cmbx-10">Every object is an instance of a class.</span></span>
   Classes define the <span 
class="cmti-10">structure </span>of their instances via instance variables, which are
private to the instance itself, and the <span 
class="cmti-10">behaviour </span>of their instances via methods, which
are all public. Each method has a name, called its <span 
class="cmti-10">selector</span>, which is unique
within the class. Methods are grouped into protocols that indicate their
intent<span class="footnote-mark"><a 
href="#fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-4001f1"></a>.
Some common protocol names have been established by convention, for example,
<span 
class="cmssi-10">accessing </span>for all accessor methods, and <span 
class="cmssi-10">initialization </span>for establishing a consistent
initial state for the object.
<!--l. 69--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-50001"></a><span 
class="cmbx-10">Every class has a superclass.</span></span>
   Each class in Smalltalk inherits its behaviour and the description of its structure
from a single <span 
class="cmti-10">superclass</span>. In Pharo, the root of the single inheritance hierarchy is
<span 
class="cmss-10">ProtoObject</span>, which encapsulates the minimal set of messages that all objects <span 
class="cmti-10">must</span>
have. Classes defined by the developer, however, should normally inherit from <span 
class="cmss-10">Object</span>
or its subclasses. Although Pharo supports only single inheritance, it supports a
mechanism called <span 
class="cmti-10">traits </span>for sharing behaviour across unrelated classes. Traits <span class="cite">[<a 
href="#XDuca06b">2</a>]</span>
are collections of methods that can be reused by multiple classes that are
not related by inheritance. Using traits allows one to share code between
different classes without duplicating code. Smalltalk has no dedicated syntax to
specify that a method or a class is abstract. By convention, the body of
an abstract method consists of the expression <span 
class="cmss-10">self subclassResponsibility</span>,
which indicates that subclasses have the responsibility to define a concrete
version of the method. A class is considered abstract if one of its methods is
abstract.
<!--l. 74--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-60001"></a><span 
class="cmbx-10">Everything happens by sending messages.</span></span>
   In Smalltalk, you do <span 
class="cmti-10">not </span>&#8220;call methods&#8221;: you &#8220;send messages&#8221;. This means that
each object has its own responsibilities. You do not <span 
class="cmti-10">tell </span>an object what to do by
                                                                  

                                                                  
applying some procedure to it (as in procedural programming). Instead, you politely
<span 
class="cmti-10">ask </span>an object to do something for you by sending it a message. The message is <span 
class="cmti-10">not </span>a
piece of code: it is nothing but a name and a list of arguments. The receiver then
decides how to respond by selecting its own <span 
class="cmti-10">method </span>for doing what was
asked. Since different objects may have different methods for responding
to the same message, the method must be chosen <span 
class="cmti-10">dynamically</span>, when the
message is received. As a consequence, you can send the <span 
class="cmti-10">same message </span>to
different objects, each of which may have <span 
class="cmti-10">its own method </span>for responding to the
message.
<!--l. 76--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-70001"></a><span 
class="cmbx-10">Method lookup follows the inheritance chain.</span></span>
   When an object receives a message, the class of the receiver looks up the method
to use to handle the message. If this class does not have a method, it asks its
superclass, and so on, up the inheritance chain. When the method is found, the
arguments are bound to the parameters of the method, and the virtual machine
executes it. When the method is not found, then the message <span 
class="cmss-10">doesNotUnderstand: </span>is
sent to <span 
class="cmss-10">self</span>. This message is implemented by default into <span 
class="cmss-10">Object</span>, creating a new
<span 
class="cmss-10">MessageNotUnderstood </span>object which is capable of starting a debugger in the current
execution context.
<!--l. 78--><br/>   <span 
class="cmss-10">super </span>sends let the developer to compose inherited behaviour that would
otherwise be overridden. The usual way to compose methods, whether inherited or
not, however, is by means of <span 
class="cmss-10">self </span>sends. <span 
class="cmss-10">self </span>sends are dynamic (i.e., bound at
execution-time) and start the method lookup again in the class of the receiver,
whereas <span 
class="cmss-10">super </span>sends are static (i.e., bound at compile-time), and start in the
superclass of class in which the <span 
class="cmss-10">super </span>send is written.
<!--l. 80--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-80001"></a><span 
class="cmbx-10">Every class is an instance of a metaclass.</span></span>
   Since <span 
class="cmti-10">classes are objects</span>, and <span 
class="cmti-10">every object is an instance of a class</span>, it follows that
classes must also be instances of classes. A class whose instances are classes is
called a <span 
class="cmti-10">metaclass</span>. Whenever you create a class, the system automatically
creates a metaclass for you, which is <span 
class="cmti-10">implicit </span>since as a programmer you
never have to worry about them. The metaclass defines the structure and
behavior of the class that is its instance. Each metaclass has only a single
instance.
<!--l. 82--><br/>   Whereas ordinary classes are named by global variables, metaclasses are
anonymous. However, you can always refer to them through the class that is their
instance. The class of <span 
class="cmss-10">Color</span>, for instance, is <span 
class="cmss-10">Color class</span>, and the class of <span 
class="cmss-10">Object </span>is
<span 
class="cmss-10">Object class</span>:
   <!--l. 84-->
   <div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-8001r1"></a></span><span 
class="cmss-9">Color</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Color</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8002r2"></a></span><span 
class="cmss-9">Object</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Object</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span>
   
   </div>
                                                                  

                                                                  
<!--l. 89--><br/>   Since classes are objects, they can have their own instance variables and their own
methods. We call these <span 
class="cmti-10">class instance variables </span>and <span 
class="cmti-10">class methods</span>, but they are really
no different from ordinary instance variables and methods: class instance variables
are just instance variables defined by a metaclass, and class methods are just
methods defined by a metaclass.
<!--l. 92--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-90001"></a><span 
class="cmbx-10">The metaclass hierarchy parallels the class hierarchy.</span></span>
   The metaclass hierarchy is parallel to the class hierarchy in the sense that the
superclass of a metaclass is constrained to be the metaclass of the superclass of the
metaclass&#8217; unique instance.
   <!--l. 96-->
   <div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-9001r1"></a></span><span 
class="cmss-9">TranslucentColor</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">superclass</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span>
<span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Color</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9002r2"></a></span><span 
class="cmss-9">TranslucentColor</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">superclass</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Color</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span>
   
   </div>
<!--l. 101--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-100001"></a><span 
class="cmbx-10">Every metaclass inherits from </span><span 
class="cmssbx-10">Class </span><span 
class="cmbx-10">and </span><span 
class="cmssbx-10">Behavior</span><span 
class="cmbx-10">.</span></span>
   Every metaclass <span 
class="cmti-10">is-a </span>class, hence inherits from <span 
class="cmss-10">Class</span>. <span 
class="cmss-10">Class</span>
in turn inherits from its superclasses, <span 
class="cmss-10">ClassDescription </span>and
<span 
class="cmss-10">Behavior</span><span class="footnote-mark"><a 
href="#fn2x0"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-10001f2"></a> .
This is important because, when the message <span 
class="cmss-10">new </span>is sent to a class, it is
looked up in its metaclass chain and ultimately in its superclasses <span 
class="cmss-10">Class</span>,
<span 
class="cmss-10">ClassDescription </span>and <span 
class="cmss-10">Behavior</span>. <span 
class="cmss-10">new </span>is first defined in the class <span 
class="cmss-10">Behavior</span>, and it can be
redefined in its subclasses, including any of the metaclasses of the classes we
define, when this is necessary. In fact, when a message <span 
class="cmss-10">new </span>is sent to a class
it is looked up, as usual, in the metaclass of this class, continuing up the
superclass chain right up to the class <span 
class="cmss-10">Behavior</span>, if it has not been redefined along
the way. Notice that there is no difference between sending a message to
an object and to a class. In both cases the search for the corresponding
method starts in the class of the receiver, and proceeds up the inheritance
chain. Thus, messages sent to classes must follow the metaclass inheritance
chain.
<!--l. 107--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-110001"></a><span 
class="cmbx-10">Every metaclass is an instance of </span><span 
class="cmssbx-10">Metaclass</span><span 
class="cmbx-10">.</span></span>
   Metaclasses are objects too; they are instances of the class <span 
class="cmss-10">Metaclass</span>. The
instances of class <span 
class="cmss-10">Metaclass </span>are the anonymous metaclasses automatically
created by the system, each of which has exactly one instance, which is a
class.
                                                                  

                                                                  
<!--l. 109--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-120001"></a><span 
class="cmbx-10">The metaclass of </span><span 
class="cmssbx-10">Metaclass </span><span 
class="cmbx-10">is an instance of </span><span 
class="cmssbx-10">Metaclass</span><span 
class="cmbx-10">.</span></span>
   Finally, the class of <span 
class="cmss-10">Metaclass class </span>is a metaclass, so it must be an instance of
<span 
class="cmss-10">Metaclass</span>, just like all the other metaclasses in the system.
<!--l. 113--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-130002"></a>Meta-programming</h3>
<!--l. 115--><p class="noindent" >As we have seen in Section <a 
href="#x1-20001">1<!--tex4ht:ref: sec:smalltalkobjmodel --></a>, in Smalltalk everything is an object, and every
object is an instance of a class. Classes are no exception: classes are objects,
and class objects are instances of other classes. This object model captures
the essence of object-oriented programming: it is lean, simple, elegant and
uniform.
<!--l. 118--><p class="indent" >   For the most of the time you will not need to think about concepts such as
metaclasses, and may happily ignore them. Sometimes, however, you will want to do
a different type of programming, one that makes use of the internal structure of
classes and objects. You may want to find out which variables are defined by a class,
which methods are implemented by it, or whether it defines a particular protocol.
You may want to do some operation for each subclass of a class. This type of
programming is called <span 
class="cmti-10">meta-programming</span>. For example, in Pharo it is used for
writing tools like the object inspector, whose sole purpose is to look inside other
objects.
<!--l. 120--><p class="indent" >   Smalltalk is a reflective programming language, which means that programs are
able to &#8220;reflect&#8221; on their own structure and execution. More technically, this means
that the <span 
class="cmti-10">metaobjects </span>of the runtime system &#8212; classes, metaclasses, method
dictionaries, compiled methods, the run-time stack, and so on &#8212; can be <span 
class="cmti-10">reified </span>as
ordinary objects, which can be queried and inspected. This form of reflection is
also called <span 
class="cmti-10">introspection</span>, and is supported by many modern programming
languages.
<!--l. 122--><p class="indent" >   Conversely, it is possible in Smalltalk to modify reified metaobjects and reflect
these changes back to the runtime system. This is also called <span 
class="cmti-10">intercession</span>, and is
supported mainly by dynamic programming languages, and only to a very limited
degree by static languages.
<!--l. 124--><p class="indent" >   A program that manipulates other programs (or even itself) is a <span 
class="cmti-10">metaprogram</span>.
For a programming language to be reflective, it should support both introspection
and intercession. Introspection is the ability to <span 
class="cmti-10">examine </span>the data structures that
define the language, such as objects, classes, methods and the execution stack.
Intercession is the ability to <span 
class="cmti-10">modify </span>these structures, in other words to change the
language semantics and the behavior of a program from within the program
itself.
<!--l. 127--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-140002.1"></a>Introspection</h4>
<!--l. 129--><p class="noindent" >An inspector can be thought of as a window onto the internals
                                                                  

                                                                  
of a particular object. By typing <span 
class="cmss-10">DateAndTime now </span>into a
playground<span class="footnote-mark"><a 
href="#fn3x0"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-14001f3"></a>  and
then action-clicking<span class="footnote-mark"><a 
href="#fn4x0"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-14002f4"></a> 
and choosing <span 
class="cmss-10">Inspect it</span>, a window like that shown in Figure&#x00A0;<a 
href="#x1-140031">1<!--tex4ht:ref: fig:theinspector --></a> will appear.
<!--l. 131--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-140031"></a>
                                                                  

                                                                  
<!--l. 133--><p class="noindent" ><img 
src="images/theinspector.png" alt="PIC" class="graphics"><!--tex4ht:graphics  
name="MarcoNaddeo0x.png" src="images/theinspector.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">Inspecting <span 
class="cmss-10">DateAndTime now</span></span></div><!--tex4ht:label?: x1-140031 -->
                                                                  

                                                                  
<!--l. 136--><p class="indent" >   </div><hr class="endfigure">
<!--l. 138--><p class="indent" >   The title bar of the window shows the printable representation of the object that
is being inspected. The <span 
class="cmti-10">Raw </span>pane shows a tree view of the object, with <span 
class="cmss-10">self </span>at the
root. Instance variables can be explored by expanding the triangles next to
their names, and selecting each of them a right pane will let you inspecting
the object (and then you can inspect the instance variables of that object,
and so on). By double-clicking on a value on the right, modifying it and
finally saving, you can also change the value of an instance variable! The
horizontal pane at the bottom of the inspector is a small playground window.
It is useful because in this window, the pseudo-variable <span 
class="cmss-10">self </span>is bound to
the object that you have selected in the upper pane. So, if you inspect it
on
   <!--l. 142-->
   <div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-14004r1"></a></span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">-</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">DateAndTime</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">today</span>
   
   </div>
<!--l. 146--><p class="indent" >   in the playground pane, the result will be a <span 
class="cmss-10">Duration </span>object that represents the
time interval between midnight today and the instant at which you evaluated
<span 
class="cmss-10">DateAndTime now </span>and created the <span 
class="cmss-10">DateAndTime </span>object that you are inspecting.
In addition to <span 
class="cmss-10">self</span>, all the instance variables of the object are in scope in
the playground pane, so you can use them in expressions or even assign to
them.
   <h5 class="subsubsectionHead"><span class="titlemark">2.1.1   </span> <a 
 id="x1-150002.1.1"></a>Accessing instance variables</h5>
<!--l. 151--><p class="noindent" >In Smalltalk, all instance variables are protected. This means that, in theory, it is
impossible to access them from another object if the class does not define any
accessor. In practice, the inspector can access instance variables without
needing accessors, because it uses the reflective abilities of Smalltalk. In
Smalltalk, classes define instance variables either by name or by numeric
indices. The inspector uses methods defined by the <span 
class="cmss-10">Object </span>class to access them:
<span 
class="cmss-10">instVarAt: </span><span 
class="cmssi-10">index </span>and <span 
class="cmss-10">instVarNamed: </span><span 
class="cmssi-10">aString </span>can be used to get the value of the
instance variable at position <span 
class="cmssi-10">index </span>or identified by <span 
class="cmssi-10">aString</span>, respectively;
to assign new values to these instance variables, it uses <span 
class="cmss-10">instVarAt:put: </span>and
<span 
class="cmss-10">instVarNamed:put:</span>. Notice that, although these methods are useful for building
development tools, using them to develop conventional applications is a bad
idea: these reflective methods break the encapsulation boundary of your
objects and can therefore make your code much harder to understand and
maintain.
<!--l. 161--><p class="indent" >   If you want to display all the values of the instance variables of a class, you can
use the method <span 
class="cmss-10">allInstVarNames </span>which returns all the names of the instance variables
of a given class. Figure&#x00A0;<a 
href="#x1-150022">2<!--tex4ht:ref: fig:allinstvars --></a> shows how to display the values of the instance variables of
an arbitrary instance (<span 
class="cmss-10">d</span>) of the class <span 
class="cmss-10">DateAndTime</span>.
<!--l. 163--><p class="indent" >   You can also gather all the instances of a class which share specific properties. For
example, to get all instances of class <span 
class="cmss-10">DateAndTime </span>whose instance variable <span 
class="cmss-10">seconds </span>is
                                                                  

                                                                  
smaller than 5, try this expression:
   <!--l. 165-->
   <div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-15001r1"></a></span><span 
class="cmss-9">DateAndTime</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allInstances</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">select</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">[:</span><span 
class="cmss-9">d</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">|</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">(</span><span 
class="cmss-9">d</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">instVarNamed</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">seconds</span><span 
class="cmss-9">&#8217;)</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmmi-9">&#x003C;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">5]</span>
   
   </div>
<!--l. 169--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-150022"></a>
                                                                  

                                                                  
<!--l. 171--><p class="noindent" ><img 
src="images/allinstvars.png" alt="PIC" class="graphics" ><!--tex4ht:graphics  
name="MarcoNaddeo1x.png" src="images/allinstvars.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;2: </span><span  
class="content">Displaying all instance variables of a <span 
class="cmss-10">DateAndTime</span></span></div><!--tex4ht:label?: x1-150022 -->
                                                                  

                                                                  
<!--l. 174--><p class="indent" >   </div><hr class="endfigure">
   <h5 class="subsubsectionHead"><span class="titlemark">2.1.2   </span> <a 
 id="x1-160002.1.2"></a>Querying classes and interfaces</h5>
<!--l. 178--><p class="noindent" >All the development tools in Pharo (code browser, debugger, inspector...) use the
reflective features we have seen so far.
<!--l. 180--><p class="indent" >   Other two messages that might be useful to build development tools are the
following:
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmss-10">isKindOf: </span><span 
class="cmssi-10">aClass </span>returns true if the receiver is instance of <span 
class="cmssi-10">aClass </span>or of one of its
     superclasses; for instance: <!--l. 184-->
     <div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-16001r1"></a></span><span 
class="cmss-9">3.5</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Float</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16002r2"></a></span><span 
class="cmss-9">3.5</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">isKindOf</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Number</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">true</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16003r3"></a></span><span 
class="cmss-9">3.5</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">isKindOf</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Integer</span><span 
class="cmss-9">&#x00A0;</span>
<span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">false</span>
     
     </div>
     </li>
     <li class="itemize"><span 
class="cmss-10">respondsTo: </span><span 
class="cmssi-10">aSymbol </span>returns true if the receiver has a method whose selector is
     <span 
class="cmssi-10">aSymbol</span>; for instance: <!--l. 190-->
     <div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-16004r1"></a></span><span 
class="cmss-9">3.5</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">respondsTo</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">floor</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">true</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8221;</span><span 
class="cmss-9">since</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Number</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">implements</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">floor</span><span 
class="cmss-9">&#8221;</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-16005r2"></a></span><span 
class="cmss-9">3.5</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">floor</span><span 
class="cmss-9">&#x00A0;</span>
<span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">3</span>
     
     </div>
     </li></ul>
<!--l. 196--><p class="indent" >   Notice that these features are normally not appropriate for typical applications:
asking an object for its class, or querying it to discover which messages it
understands, are typical signs of design problems, since they violate the principle of
encapsulation. Development tools, however, are not normal applications, since their
domain is that of software itself. As such these tools have a right to dig deep into the
internal details of code.
<!--l. 200--><p class="noindent" >
   <h5 class="subsubsectionHead"><span class="titlemark">2.1.3   </span> <a 
 id="x1-170002.1.3"></a>Code metrics</h5>
<!--l. 202--><p class="noindent" >Smalltalk&#8217;s introspection features can be used to quickly extract some useful code
metrics. <span 
class="cmss-10">Morph </span>is the superclass of all graphical objects in Pharo:
     <ul class="itemize1">
     <li class="itemize">depth of the inheritance hierarchy <!--l. 206-->
     <div class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-17001r1"></a></span><span 
class="cmss-9">Morph</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allSuperclasses</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">size</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">2</span>
     
                                                                  

                                                                  
     </div>
     </li>
     <li class="itemize">number of methods <!--l. 210-->
     <div class="lstlisting" id="listing-8"><span class="label"><a 
 id="x1-17002r1"></a></span><span 
class="cmss-9">Morph</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allSelectors</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">size</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">1275</span>
     
     </div>
     </li>
     <li class="itemize">number of instance variables <!--l. 214-->
     <div class="lstlisting" id="listing-9"><span class="label"><a 
 id="x1-17003r1"></a></span><span 
class="cmss-9">Morph</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allInstVarNames</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">size</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">6</span>
     
     </div>
     </li>
     <li class="itemize">number of locally defined methods <!--l. 218-->
     <div class="lstlisting" id="listing-10"><span class="label"><a 
 id="x1-17004r1"></a></span><span 
class="cmss-9">Morph</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">selectors</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">size</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">895</span>
     
     </div>
     </li>
     <li class="itemize">number of locally defined instance variables <!--l. 222-->
     <div class="lstlisting" id="listing-11"><span class="label"><a 
 id="x1-17005r1"></a></span><span 
class="cmss-9">Morph</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">instVarNames</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">size</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">6</span>
     
     </div>
     </li>
     <li class="itemize">number of direct subclasses <!--l. 226-->
     <div class="lstlisting" id="listing-12"><span class="label"><a 
 id="x1-17006r1"></a></span><span 
class="cmss-9">Morph</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">subclasses</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">size</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">55</span>
     
     </div>
     </li>
     <li class="itemize">number of total subclasses <!--l. 230-->
     <div class="lstlisting" id="listing-13"><span class="label"><a 
 id="x1-17007r1"></a></span><span 
class="cmss-9">Morph</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allSubclasses</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">size</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">360</span>
     
     </div>
     </li>
     <li class="itemize">total lines of code <!--l. 234-->
     <div class="lstlisting" id="listing-14"><span class="label"><a 
 id="x1-17008r1"></a></span><span 
class="cmss-9">Morph</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">linesOfCode</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">4962</span>
     
                                                                  

                                                                  
     </div>
     </li></ul>
<!--l. 239--><p class="indent" >   The analysis reveals that <span 
class="cmss-10">Morph </span>is a huge class, and that it is at the root of a
huge hierarchy. Maybe it needs some refactoring!
<!--l. 241--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-180002.2"></a>Browsing code</h4>
<!--l. 243--><p class="noindent" >In Smalltalk, classes are objects &#8212; as well as everything else &#8212; that provide useful
features for navigating through their instances. Most of the messages we will
look at now are implemented in <span 
class="cmss-10">Behavior</span>, so they are understood by all
classes.
<!--l. 245--><p class="indent" >   It is possible to obtain an instance of a given class by sending it the message
<span 
class="cmss-10">someInstance</span>:
   <!--l. 248-->
   <div class="lstlisting" id="listing-15"><span class="label"><a 
 id="x1-18001r1"></a></span><span 
class="cmss-9">Point</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">someInstance</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">0</span><span 
class="cmss-9">@0</span>
   
   </div>
<!--l. 252--><p class="indent" >   It is also possible to gather all the instances with <span 
class="cmss-10">allInstances</span>, or the number of
alive instances in memory with <span 
class="cmss-10">instanceCount</span>:
   <!--l. 254-->
   <div class="lstlisting" id="listing-16"><span class="label"><a 
 id="x1-18002r1"></a></span><span 
class="cmss-9">ByteString</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allInstances</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span>
<span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#(&#8217;</span><span 
class="cmss-9">collection</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">position</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">...)</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18003r2"></a></span><span 
class="cmss-9">ByteString</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">instanceCount</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span>
<span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">55736</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18004r3"></a></span><span 
class="cmss-9">String</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allSubInstances</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">size</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">116381</span>
   
   </div>
<!--l. 260--><p class="indent" >   A feature that can be very useful while debugging an application is asking a class
to enumerate those of its methods exhibiting specific properties:
     <ul class="itemize1">
     <li class="itemize">all selectors of methods that read or write the instance variable named by the
     argument <!--l. 264-->
     <div class="lstlisting" id="listing-17"><span class="label"><a 
 id="x1-18005r1"></a></span><span 
class="cmss-9">Point</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">whichSelectorsAccess</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">x</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#(#</span><span 
class="cmss-9">x</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">theta</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">quadrantOf</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">...)</span>
     
     </div>
     </li>
     <li class="itemize">the selectors of methods that modify the value of an instance variable
     <!--l. 268-->
     <div class="lstlisting" id="listing-18"><span class="label"><a 
 id="x1-18006r1"></a></span><span 
class="cmss-9">Point</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">whichSelectorsStoreInto</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">x</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#(#</span><span 
class="cmss-9">bitShiftPoint</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">setX</span><span 
class="cmss-9">:</span><span 
class="cmss-9">setY</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">...)</span>
     
                                                                  

                                                                  
     </div>
     </li>
     <li class="itemize">the selectors of methods that send a given message <!--l. 273-->
     <div class="lstlisting" id="listing-19"><span class="label"><a 
 id="x1-18007r1"></a></span><span 
class="cmss-9">Point</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">whichSelectorsReferTo</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#+</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">an</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">IdentitySet</span><span 
class="cmss-9">(#+</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">degrees</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">...)</span>
     
     </div>
     </li>
     <li class="itemize">the superclass that implements the given message <!--l. 277-->
     <div class="lstlisting" id="listing-20"><span class="label"><a 
 id="x1-18008r1"></a></span><span 
class="cmss-9">Rectangle</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">whichClassIncludesSelector</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">inspect</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Object</span>
     
     </div>
     </li>
     <li class="itemize">the instance variables that are neither used in the receiver class nor any of its
     subclasses <!--l. 281-->
     <div class="lstlisting" id="listing-21"><span class="label"><a 
 id="x1-18009r1"></a></span><span 
class="cmss-9">Rectangle</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">unreferencedInstanceVariables</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#()</span>
     
     </div>
     </li></ul>
<!--l. 286--><p class="indent" >   <span 
class="cmss-10">SystemNavigation </span>is a facade that allows you to query and browse the source code
of the system. <span 
class="cmss-10">SystemNavigation default </span>returns an instance you can use to navigate
the system. For example:
   <!--l. 288-->
   <div class="lstlisting" id="listing-22"><span class="label"><a 
 id="x1-18010r1"></a></span><span 
class="cmss-9">SystemNavigation</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">default</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allClassesImplementing</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">yourself</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span>
<span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">{</span><span 
class="cmss-9">Object</span><span 
class="cmsy-9">}</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18011r2"></a></span><span 
class="cmss-9">SystemNavigation</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">default</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allSentMessages</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">size</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span>
<span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">35592</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18012r3"></a></span><span 
class="cmss-9">SystemNavigation</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">default</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allUnimplementedCalls</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">size</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span>
<span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">383</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18013r4"></a></span><span 
class="cmss-9">SystemNavigation</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">default</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">allCallsOn</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">Point</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18014r5"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span>
<span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">an</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">OrderedCollection</span><span 
class="cmss-9">(</span><span 
class="cmss-9">DangerousClassNotifier</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmmi-9">&#x003E;&#x003E;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">tooDangerousClasses</span><span 
class="cmss-9">)</span>
   
   </div>
<!--l. 296--><p class="indent" >   Note that messages sent but not implemented are quite problematic,
because the methods sending these messages will fail at runtime. There
may be some sign of unfinished implementation, obsolete APIs, or missing
libraries.
<!--l. 298--><p class="indent" >   All these features are integrated in the programming environment of Pharo, in
particular in the code browsers&#x00A0;<span class="cite">[<a 
href="#XBlac09a">1</a>]</span>; the fastest way to access them is using some
convenient keyboard shortcuts, e.g., for browsing all i<span class="underline">m</span>plementors (CMD-m) and
se<span class="underline">n</span>ders (CMD-n) of a given message. Anyway, there are two other ways to
programmatically query and browse system code:
                                                                  

                                                                  
     <ul class="itemize1">
     <li class="itemize">there  are  many  pre-packaged  queries  implemented  as  methods  of  the
     <span 
class="cmss-10">SystemNavigation </span>class in the <span 
class="cmssi-10">browsing  </span>protocol; for instance, Figure&#x00A0;<a 
href="#x1-180153">3<!--tex4ht:ref: fig:browseallimplementorsof --></a>
     shows  how  you  can  programmatically  browse  all  implementors  of  the
     <span 
class="cmss-10">ifTrue: </span>message;
     </li>
     <li class="itemize">the Refactoring Browser, which is integrated into Pharo, provides both
     interactive and programmatic ways to compose complex queries; please
     refer to&#x00A0;<span class="cite">[<a 
href="#XBlac09a">1</a>]</span> for details.</li></ul>
<!--l. 306--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-180153"></a>
                                                                  

                                                                  
<!--l. 308--><p class="noindent" ><img 
src="images/browsingallimplementorsof.png" alt="PIC" class="graphics" ><!--tex4ht:graphics  
name="MarcoNaddeo2x.png" src="images/browsingallimplementorsof.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;3: </span><span  
class="content">Browsing all implementations of <span 
class="cmss-10">#ifTrue:</span></span></div><!--tex4ht:label?: x1-180153 -->
                                                                  

                                                                  
<!--l. 311--><p class="indent" >   </div><hr class="endfigure">
   <h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-190002.3"></a>Classes, method dictionaries and methods</h4>
<!--l. 315--><p class="noindent" >Since classes are objects, we can inspect them just like any other object:
   <!--l. 317-->
   <div class="lstlisting" id="listing-23"><span class="label"><a 
 id="x1-19001r1"></a></span><span 
class="cmss-9">Point</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">inspect</span>
   
   </div>
<!--l. 321--><p class="indent" >   In Figure&#x00A0;<a 
href="#x1-190024">4<!--tex4ht:ref: fig:pointclassinspector --></a>, the inspector shows the structure of class <span 
class="cmss-10">Point</span>. You can see
that the class stores its methods in a dictionary, indexing them by their
selector.
<!--l. 323--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-190024"></a>
                                                                  

                                                                  
<!--l. 325--><p class="noindent" ><img 
src="images/pointclassinspector.png" alt="PIC" class="graphics" ><!--tex4ht:graphics  
name="MarcoNaddeo3x.png" src="images/pointclassinspector.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;4: </span><span  
class="content">Inspecting class <span 
class="cmss-10">Point</span></span></div><!--tex4ht:label?: x1-190024 -->
                                                                  

                                                                  
<!--l. 328--><p class="indent" >   </div><hr class="endfigure">
<!--l. 330--><p class="indent" >   We can exploit the method dictionary to pose queries about the system. For
example, to discover which methods are newly introduced in a given class, i.e., do not
override superclass methods, we can navigate from the class to the method dictionary
as follows:
   <!--l. 333-->
   <div class="lstlisting" id="listing-24"><span class="label"><a 
 id="x1-19003r1"></a></span><span 
class="cmss-9">[:</span><span 
class="cmss-9">aClass</span><span 
class="cmsy-9">|</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aClass</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">methodDict</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">keys</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">select</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">[:</span><span 
class="cmss-9">aMethod</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">|</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19004r2"></a></span><span 
class="cmss-9">(</span><span 
class="cmss-9">aClass</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">superclass</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">canUnderstand</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aMethod</span><span 
class="cmss-9">)</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">not</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">]]</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">value</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">SmallInteger</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19005r3"></a></span>
<span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#(#</span><span 
class="cmss-9">threeDigitName</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">highBitOfPositiveReceiver</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">...)</span>
   
   </div>
<!--l. 339--><p class="indent" >   The method dictionary maps method selectors to compiled methods.
A compiled method does not simply store the bytecode of a method. It is
also an object the provides numerous useful methods for querying the
system. One such method is <span 
class="cmss-10">isAbstract </span>(which tells if the method sends
<span 
class="cmss-10">subclassResponsibility</span><span class="footnote-mark"><a 
href="#fn5x0"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-19006f5"></a> ).
We can use it to identify all the abstract methods of an abstract class:
   <!--l. 342-->
   <div class="lstlisting" id="listing-25"><span class="label"><a 
 id="x1-19007r1"></a></span><span 
class="cmss-9">[:</span><span 
class="cmss-9">aClass</span><span 
class="cmsy-9">|</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aClass</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">methodDict</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">keys</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">select</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">[:</span><span 
class="cmss-9">aMethod</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">|</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19008r2"></a></span><span 
class="cmss-9">(</span><span 
class="cmss-9">aClass</span><span 
class="cmmi-9">&#x003E;&#x003E;</span><span 
class="cmss-9">aMethod</span><span 
class="cmss-9">)</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">isAbstract</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">]]</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">value</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Number</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-19009r3"></a></span>
<span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#(#</span><span 
class="cmss-9">nthRoot</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#+</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">sqrt</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">storeOn</span><span 
class="cmss-9">:</span><span 
class="cmss-9">base</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">...)</span>
   
   </div>
<!--l. 348--><p class="indent" >   Note that this code sends the <span 
class="cmmi-10">&#x003E;&#x003E; </span>message to a class to obtain the compiled
method for a given selector.
   <h4 class="subsectionHead"><span class="titlemark">2.4   </span> <a 
 id="x1-200002.4"></a>Accessing the run-time context</h4>
<!--l. 352--><p class="noindent" >You can access the run-time context of an executing method and explore it just
like any other object, through the pseudo-variable <span 
class="cmss-10">thisContext</span>. Whenever
<span 
class="cmss-10">thisContext </span>is referred to in a running method, the entire run-time context of
that method is reified and made available as a series of chained <span 
class="cmss-10">Context</span>
objects.
<!--l. 354--><p class="indent" >   As an example of use of <span 
class="cmss-10">thisContext</span>, you can try to change the definition of
<span 
class="cmss-10">Integer</span><span 
class="cmmi-10">&#x003E;&#x003E;</span><span 
class="cmss-10">factorial </span>by inserting the underlined expression as shown below:
   <!--l. 356-->
   <div class="lstlisting" id="listing-26"><span class="label"><a 
 id="x1-20001r1"></a></span><span 
class="cmss-9">Integer</span><span 
class="cmmi-9">&#x003E;&#x003E;</span><span 
class="cmss-9">factorial</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20002r2"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8221;</span><span 
class="cmss-9">Answer</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">the</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">factorial</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">of</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">the</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">receiver</span><span 
class="cmss-9">.&#8221;</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20003r3"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">=</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">0</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">ifTrue</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">[</span><span class="underline"><span 
class="cmss-9">thisContext</span>
<span 
class="cmss-9">explore.selfhalt.</span></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x02C6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">1].</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20004r4"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmmi-9">&#x003E;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">0</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">ifTrue</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">[&#x02C6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">*</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">(</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">-</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">1)</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">factorial</span><span 
class="cmss-9">].</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20005r5"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">error</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">Not</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">valid</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">for</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">negative</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">integers</span><span 
class="cmss-9">&#8217;</span>
   
   </div>
                                                                  

                                                                  
<!--l. 364--><p class="indent" >   The Smalltalk way to set a breakpoint is to evaluate <span 
class="cmss-10">self halt </span>at an interesting
point in a method. This will cause <span 
class="cmss-10">thisContext </span>to be reified, and a debugger window
will open at the breakpoint.
<!--l. 366--><p class="indent" >   If you now evaluate <span 
class="cmss-10">3 factorial </span>in a playground, you should obtain both a
debugger window and an explorer, as shown in Figure&#x00A0;<a 
href="#x1-200065">5<!--tex4ht:ref: fig:exploringthiscontext --></a>.
<!--l. 368--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-200065"></a>
                                                                  

                                                                  
<!--l. 370--><p class="noindent" ><img 
src="images/exploringthiscontext.png" alt="PIC" class="graphics" ><!--tex4ht:graphics  
name="MarcoNaddeo4x.png" src="images/exploringthiscontext.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5: </span><span  
class="content">Exploring <span 
class="cmss-10">thisContext</span></span></div><!--tex4ht:label?: x1-200065 -->
                                                                  

                                                                  
<!--l. 373--><p class="indent" >   </div><hr class="endfigure">
<!--l. 375--><p class="indent" >   If you now browse the class of the explored object (i.e., by evaluating <span 
class="cmss-10">self browse</span>
in the bottom pane of the explorer) you will discover that it is an instance of the
class <span 
class="cmss-10">Context</span>, as each sender in the chain. Obviously, <span 
class="cmss-10">thisContext </span>is not intended to
be used for day-to-day programming, but it is essential for implementing tools like
debuggers, and for accessing information about the call stack. For example,
<span 
class="cmss-10">thisContext </span>can be used to discover the sender of a message. If you look at the
implementation of the message <span 
class="cmss-10">subclassResponsibility </span>in the class <span 
class="cmss-10">Object</span>, you will see
that it provides a useful error message, indicating which method has been invoked, by
asking <span 
class="cmss-10">thisContext </span>for the sender:
   <!--l. 379-->
   <div class="lstlisting" id="listing-27"><span class="label"><a 
 id="x1-20007r1"></a></span><span 
class="cmss-9">subclassResponsibility</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20008r2"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8221;</span><span 
class="cmss-9">This</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">message</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">sets</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">up</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">a</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">framework</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">for</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">the</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">behavior</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">of</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">the</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">subclasses</span><span 
class="cmss-9">.</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20009r3"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Announce</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">that</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">the</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">subclass</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">should</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">have</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">implemented</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">this</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">message</span><span 
class="cmss-9">.&#8221;</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20010r4"></a></span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20011r5"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">SubclassResponsibility</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">signalFor</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">thisContext</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">sender</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">selector</span>
   
   </div>
   <h4 class="subsectionHead"><span class="titlemark">2.5   </span> <a 
 id="x1-210002.5"></a>Intercepting messages not understood</h4>
<!--l. 389--><p class="noindent" >The reflective features of Smalltalk can also be used to intercept messages and
modify behaviour at run-time.
<!--l. 391--><p class="indent" >   In Section&#x00A0;<a 
href="#x1-20001">1<!--tex4ht:ref: sec:smalltalkobjmodel --></a> we have seen that the method lookup follows the inheritance chain:
when an object receives a message, it first looks in the method dictionary of its class
for a corresponding method to respond to the message. If no such method exists, it
will continue looking up the class hierarchy, until it reaches <span 
class="cmss-10">Object</span>. If still no
method is found for that message, the object will send <span 
class="cmti-10">itself  </span>the message
<span 
class="cmss-10">doesNotUnderstand: </span>with the message selector as its argument. The process then
starts all over again, until <span 
class="cmss-10">Object</span><span 
class="cmmi-10">&#x003E;&#x003E;</span><span 
class="cmss-10">doesNotUnderstand: </span>is found, and the debugger is
launched.
<!--l. 394--><p class="indent" >   Subclasses of <span 
class="cmss-10">Object </span>can override <span 
class="cmss-10">doesNotUnderstand: </span>at the aim of realizing
certain kinds of very dynamic behaviour: an object that does not understand a
message can, by overriding <span 
class="cmss-10">doesNotUnderstand:</span>, fall back to an alternative strategy
for responding to that message.
<!--l. 396--><p class="noindent" >
   <h5 class="subsubsectionHead"><span class="titlemark">2.5.1   </span> <a 
 id="x1-220002.5.1"></a>Lightweight proxies</h5>
<!--l. 398--><p class="noindent" >Such a strategy can be that of introducing a &#8220;minimal object&#8221; to act as a proxy for
an existing object. Since the proxy will implement no methods of its own, any
message sent to it will be trapped by <span 
class="cmss-10">doesNotUnderstand:</span>. By implementing this
message, the proxy can then take special action before delegating the message to the
real subject it is the proxy for.
<!--l. 400--><p class="indent" >   As an example, we can define a <span 
class="cmss-10">LoggingProxy </span>as
                                                                  

                                                                  
follows<span class="footnote-mark"><a 
href="#fn6x0"><sup class="textsuperscript">6</sup></a></span><a 
 id="x1-22001f6"></a> :
   <!--l. 402-->
   <div class="lstlisting" id="listing-28"><span class="label"><a 
 id="x1-22002r1"></a></span><span 
class="cmss-9">ProtoObject</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">subclass</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">LoggingProxy</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22003r2"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">instanceVariableNames</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">subject</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">invocationCount</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22004r3"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">classVariableNames</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;&#8217;</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22005r4"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">poolDictionaries</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;&#8217;</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22006r5"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">category</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">PBEReflection</span><span 
class="cmss-9">&#8217;</span>
   
   </div>
<!--l. 410--><p class="indent" >   Our proxy has two instance variables: the <span 
class="cmss-10">subject </span>points to the object this proxy
is for, and <span 
class="cmss-10">invocationCount </span>is a counter of the number of messages it has
intercepted.
<!--l. 412--><p class="indent" >   We initialize the two instance variables and we provide an accessor for
the message count. Initially the <span 
class="cmss-10">subject </span>variable points to the proxy object
itself:
   <!--l. 414-->
   <div class="lstlisting" id="listing-29"><span class="label"><a 
 id="x1-22007r1"></a></span><span 
class="cmss-9">LoggingProxy</span><span 
class="cmmi-9">&#x003E;&#x003E;</span><span 
class="cmss-9">initialize</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22008r2"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">invocationCount</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">:=</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">0.</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22009r3"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">subject</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">:=</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">self</span><span 
class="cmss-9">.</span>
   
   </div>
   <!--l. 420-->
   <div class="lstlisting" id="listing-30"><span class="label"><a 
 id="x1-22010r1"></a></span><span 
class="cmss-9">LoggingProxy</span><span 
class="cmmi-9">&#x003E;&#x003E;</span><span 
class="cmss-9">invocationCount</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22011r2"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x02C6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">invocationCount</span>
   
   </div>
<!--l. 425--><p class="indent" >   We simply intercept all messages not understood, print them to the
<span 
class="cmss-10">Transcript</span><span class="footnote-mark"><a 
href="#fn7x0"><sup class="textsuperscript">7</sup></a></span><a 
 id="x1-22012f7"></a> ,
update the message count, and forward the message to the real subject:
   <!--l. 427-->
   <div class="lstlisting" id="listing-31"><span class="label"><a 
 id="x1-22013r1"></a></span><span 
class="cmss-9">LoggingProxy</span><span 
class="cmmi-9">&#x003E;&#x003E;</span><span 
class="cmss-9">doesNotUnderstand</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aMessage</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22014r2"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Transcript</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">show</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">performing</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;,</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aMessage</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">printString</span><span 
class="cmss-9">;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">cr</span><span 
class="cmss-9">.</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22015r3"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">invocationCount</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">:=</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">invocationCount</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">+</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">1.</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22016r4"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x02C6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aMessage</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">sendTo</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">subject</span>
   
   </div>
<!--l. 434--><p class="indent" >   At this point, to swap all references in the system to a certain object
to refer to the proxy, and vice versa, it is possible to use the message
                                                                  

                                                                  
<span 
class="cmss-10">become:</span><span class="footnote-mark"><a 
href="#fn8x0"><sup class="textsuperscript">8</sup></a></span><a 
 id="x1-22017f8"></a> 
of the <span 
class="cmss-10">ProtoObject </span>class. For example, we can create a new <span 
class="cmss-10">Point </span>object and
a new <span 
class="cmss-10">LoggingProxy </span>object, and then tell the proxy to <span 
class="cmti-10">become </span>the point
object:
   <!--l. 436-->
   <div class="lstlisting" id="listing-32"><span class="label"><a 
 id="x1-22018r1"></a></span><span 
class="cmss-9">point</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">:=</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">1</span><span 
class="cmss-9">@2</span><span 
class="cmss-9">.</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22019r2"></a></span><span 
class="cmss-9">LoggingProxy</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">new</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">become</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">point</span><span 
class="cmss-9">.</span>
   
   </div>
<!--l. 441--><p class="indent" >   Notice that now the proxy&#8217;s <span 
class="cmss-10">subject </span>instance variable will refer to the
point:
   <!--l. 443-->
   <div class="lstlisting" id="listing-33"><span class="label"><a 
 id="x1-22020r1"></a></span><span 
class="cmss-9">point</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">invocationCount</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">0</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22021r2"></a></span><span 
class="cmss-9">point</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">+</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">(3</span><span 
class="cmss-9">@4</span><span 
class="cmss-9">)</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">4</span><span 
class="cmss-9">@6</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22022r3"></a></span><span 
class="cmss-9">point</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">invocationCount</span><span 
class="cmss-9">&#x00A0;</span>
<span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">1</span>
   
   </div>
<!--l. 449--><p class="indent" >   This works nicely in most cases, but there are some limitations: for example, since
the method <span 
class="cmss-10">class </span>is never sent as a message but is directly answered by the virtual
machine, you will obtain the following result:
   <!--l. 451-->
   <div class="lstlisting" id="listing-34"><span class="label"><a 
 id="x1-22023r1"></a></span><span 
class="cmss-9">point</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">LoggingProxy</span>
   
   </div>
<!--l. 455--><p class="indent" >   Moreover, <span 
class="cmss-10">self</span>-sends cannot be intercepted. This means that sending a message
which in turn sends other messages to <span 
class="cmss-10">self</span>, our proxy will be cheated out of these
<span 
class="cmss-10">self</span>-sends.
<!--l. 457--><p class="indent" >   Although messages can be intercepted by proxies using this technique, you should
be aware of the inherent limitations of using a proxy. In Section <a 
href="#x1-240002.6">2.6<!--tex4ht:ref: sec:objasmethodwraps --></a> we will see
another, more general approach for intercepting messages.
   <h5 class="subsubsectionHead"><span class="titlemark">2.5.2   </span> <a 
 id="x1-230002.5.2"></a>Generating missing methods</h5>
<!--l. 461--><p class="noindent" >Another common application of intercepting not understood messages is to
dynamically load or generate the missing methods. Imagine that we have a very
large library of classes with many methods. Instead of loading the entire
library, we could load a stub for each class in the library. The stubs know
where to find the source code of all their methods. The stubs simply trap
all messages not understood, and dynamically load the missing methods
on-demand.
<!--l. 464--><p class="indent" >   A simple variant of this technique can be used to implement a class that
automatically adds accessors for its instance variables on-demand:
                                                                  

                                                                  
   <!--l. 466-->
   <div class="lstlisting" id="listing-35"><span class="label"><a 
 id="x1-23001r1"></a></span><span 
class="cmss-9">DynamicAcccessors</span><span 
class="cmmi-9">&#x003E;&#x003E;</span><span 
class="cmss-9">doesNotUnderstand</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aMessage</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23002r2"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">|</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">messageName</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">|</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23003r3"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">messageName</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">:=</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aMessage</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">selector</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">asString</span><span 
class="cmss-9">.</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23004r4"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">(</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">instVarNames</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">includes</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">messageName</span><span 
class="cmss-9">)</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23005r5"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">ifTrue</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">[</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23006r6"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">compile</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">messageName</span><span 
class="cmss-9">,</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">String</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">cr</span><span 
class="cmss-9">,</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x02C6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;,</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">messageName</span><span 
class="cmss-9">.</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23007r7"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x02C6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aMessage</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">sendTo</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">].</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23008r8"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x02C6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">super</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">doesNotUnderstand</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aMessage</span>
   
   </div>
<!--l. 477--><p class="indent" >   Any message not understood will be trapped here: if an instance variable
with the same name as the message sent exists, then we ask our class to
compile an accessor for that instance variables and we re-send the message.
Note that the message <span 
class="cmss-10">sendTo: </span>is implemented in the class <span 
class="cmss-10">Message </span>in this
way:
   <!--l. 479-->
   <div class="lstlisting" id="listing-36"><span class="label"><a 
 id="x1-23009r1"></a></span><span 
class="cmss-9">Message</span><span 
class="cmmi-9">&#x003E;&#x003E;</span><span 
class="cmss-9">sendTo</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">receiver</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23010r2"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8221;</span><span 
class="cmss-9">answer</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">the</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">result</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">of</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">sending</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">this</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">message</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">to</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">receiver</span><span 
class="cmss-9">&#8221;</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23011r3"></a></span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23012r4"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x02C6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">receiver</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">perform</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">selector</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">withArguments</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">args</span>
   
   </div>
<!--l. 486--><p class="indent" >   <span 
class="cmss-10">Object</span><span 
class="cmmi-10">&#x003E;&#x003E;</span><span 
class="cmss-10">perform: </span>is very useful because it can be used to send messages that are
composed at run-time:
   <!--l. 489-->
   <div class="lstlisting" id="listing-37"><span class="label"><a 
 id="x1-23013r1"></a></span><span 
class="cmss-9">5</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">perform</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">factorial</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">120</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23014r2"></a></span><span 
class="cmss-9">6</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">perform</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">(&#8217;</span><span 
class="cmss-9">fac</span><span 
class="cmss-9">&#8217;,</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8217;</span><span 
class="cmss-9">torial</span><span 
class="cmss-9">&#8217;)</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">asSymbol</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span>
<span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">720</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23015r3"></a></span><span 
class="cmss-9">4</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">perform</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">max</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">withArguments</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">(</span><span 
class="cmss-9">Array</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">with</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">6)</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">6</span>
   
   </div>
<!--l. 495--><p class="indent" >   Suppose now that the class <span 
class="cmss-10">DynamicAcccessors </span>has an (uninitialized) instance
variable <span 
class="cmss-10">x </span>but no pre-defined accessor. Then the following code will generate the
accessor dynamically and retrieve the value:
   <!--l. 498-->
   <div class="lstlisting" id="listing-38"><span class="label"><a 
 id="x1-23016r1"></a></span><span 
class="cmss-9">myDA</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">:=</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">DynamicAccessors</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">new</span><span 
class="cmss-9">.</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23017r2"></a></span><span 
class="cmss-9">myDA</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">x</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">nil</span>
   
   </div>
<!--l. 503--><p class="indent" >   The same technique can be used to generate setters for instance variables, or
other kinds of boilerplate code, such as visiting methods for a Visitor.
<!--l. 505--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.6   </span> <a 
 id="x1-240002.6"></a>Objects as method wrappers</h4>
<!--l. 507--><p class="noindent" >In Section <a 
href="#x1-190002.3">2.3<!--tex4ht:ref: sec:classesdictsandmethods --></a> we have seen that compiled methods are ordinary objects in Smalltalk,
and they support a number of methods that allow the programmer to query the
run-time system. Actually, <span 
class="cmti-10">any </span>object can play the role of a compiled method: all it
has to do is respond to the method <span 
class="cmss-10">run:with:in: </span>and a few other important
messages<span class="footnote-mark"><a 
href="#fn9x0"><sup class="textsuperscript">9</sup></a></span><a 
 id="x1-24001f9"></a> .
                                                                  

                                                                  
<!--l. 509--><p class="indent" >   After having defined an empty class <span 
class="cmss-10">Demo</span>, you can install a plain Smalltalk
object in its method dictionary by evaluating:
   <!--l. 511-->
   <div class="lstlisting" id="listing-39"><span class="label"><a 
 id="x1-24002r1"></a></span><span 
class="cmss-9">Demo</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">methodDict</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">at</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">answer42</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">put</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">ObjectsAsMethodsExample</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">new</span>
   
   </div>
<!--l. 515--><p class="indent" >   An instance of the class <span 
class="cmss-10">Demo </span>is now able to answer the message <span 
class="cmss-10">answer42</span>:
   <!--l. 517-->
   <div class="lstlisting" id="listing-40"><span class="label"><a 
 id="x1-24003r1"></a></span><span 
class="cmss-9">Demo</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">new</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">answer42</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">42</span>
   
   </div>
<!--l. 521--><p class="indent" >   If you take a look at the class <span 
class="cmss-10">ObjectsAsMethodsExample </span>you will find the
following methods:
   <!--l. 523-->
   <div class="lstlisting" id="listing-41"><span class="label"><a 
 id="x1-24004r1"></a></span><span 
class="cmss-9">answer42</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24005r2"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x02C6;42</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24006r3"></a></span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24007r4"></a></span><span 
class="cmss-9">run</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">oldSelector</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">with</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">arguments</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">in</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">aReceiver</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24008r5"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x02C6;</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">perform</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">oldSelector</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">withArguments</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">arguments</span>
   
   </div>
<!--l. 531--><p class="indent" >   When the <span 
class="cmss-10">Demo </span>instance receives the message <span 
class="cmss-10">answer42</span>, method lookup
proceeds as usual, however the virtual machine will detect that in place
of a compiled method, an ordinary Smalltalk object is trying to play this
role. The VM will then send this object a new message <span 
class="cmss-10">run:with:in: </span>with
the original method selector, arguments and receiver as arguments. Since
<span 
class="cmss-10">ObjectsAsMethodsExample </span>implements this method, it intercepts the message and
delegates it to itself.
<!--l. 533--><p class="indent" >   You can remove the fake method as follows:
   <!--l. 535-->
   <div class="lstlisting" id="listing-42"><span class="label"><a 
 id="x1-24009r1"></a></span><span 
class="cmss-9">Demo</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">methodDict</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">removeKey</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">#</span><span 
class="cmss-9">answer42</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">ifAbsent</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">[]</span>
   
   </div>
<!--l. 539--><p class="indent" >   Method wrappers are a well-known technique for intercepting
messages<span class="footnote-mark"><a 
href="#fn10x0"><sup class="textsuperscript">10</sup></a></span><a 
 id="x1-24010f10"></a> . A
method wrapper is an instance of a subclass of <span 
class="cmss-10">CompiledMethod</span>, or it can be implemented
more easily by implementing <span 
class="cmss-10">run:with:in:</span>. When installed, a method wrapper can perform
special actions before or after invoking, with <span 
class="cmss-10">perform:withArguments:</span>, the original
                                                                  

                                                                  
method<span class="footnote-mark"><a 
href="#fn11x0"><sup class="textsuperscript">11</sup></a></span><a 
 id="x1-24011f11"></a> :
typical applications are instrumentation (collecting statistics about the calling
patterns of methods), checking optional pre- and post-conditions, and memoization
(optionally caching computed values of methods). When uninstalled, the original
method is returned to its rightful position in the method dictionary. Please refer
to&#x00A0;<span class="cite">[<a 
href="#XBlac09a">1</a>]</span> about how the Pharo Test Runner uses the technique of method wrappers to
evaluate test coverage.
   <h4 class="subsectionHead"><span class="titlemark">2.7   </span> <a 
 id="x1-250002.7"></a>Pragmas</h4>
<!--l. 544--><p class="noindent" >A <span 
class="cmti-10">pragma </span>is an annotation (delimited by angle brackets <span 
class="cmmi-10">&#x003C;&#x003E;</span>) that specifies data
about a program, but is not involved in the execution of the program. Pragmas have
no direct effect on the operation of the method they annotate. Pragmas have a
number of uses, among them:
     <ul class="itemize1">
     <li class="itemize">information for the compiler: pragmas can be used by the compiler to
     make a method call a primitive function; this function has to be defined
     by the virtual machine or by an external plugging;
     </li>
     <li class="itemize">runtime  processing:  some  pragmas  are  available  to  be  examined  at
     runtime.</li></ul>
<!--l. 552--><p class="indent" >   Pragmas can be applied to a program&#8217;s method declarations only. A method may
declare one or more pragmas, and the pragmas have to be declared prior any
Smalltalk statement. Each pragma is in effect a static message send with literal
arguments.
<!--l. 555--><p class="indent" >   A primitive<span class="footnote-mark"><a 
href="#fn12x0"><sup class="textsuperscript">12</sup></a></span><a 
 id="x1-25001f12"></a> 
is nothing more than a pragma declaration. In fact, primitives are invoked with
the syntax <span 
class="cmmi-10">&#x003C;</span><span 
class="cmss-10">primitive: aNumber</span><span 
class="cmmi-10">&#x003E;</span>. For example, <span 
class="cmss-10">instVarAt: </span>is a primitive
method, meaning that it is implemented as a primitive operation of the
Pharo virtual machine (performed directly by the interpreter rather than by
evaluating expressions in a method). Consider <span 
class="cmmi-10">&#x003C;</span><span 
class="cmss-10">primitive: 73</span><span 
class="cmmi-10">&#x003E; </span>as contained in
<span 
class="cmss-10">instVarAt:</span>:
   <!--l. 557-->
                                                                  

                                                                  
   <div class="lstlisting" id="listing-43"><span class="label"><a 
 id="x1-25002r1"></a></span><span 
class="cmss-9">Object</span><span 
class="cmmi-9">&#x003E;&#x003E;</span><span 
class="cmss-9">instVarAt</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">index</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25003r2"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8221;</span><span 
class="cmss-9">Primitive</span><span 
class="cmss-9">.</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Answer</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">a</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">fixed</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">variable</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">in</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">an</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">object</span><span 
class="cmss-9">.</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">...&#8221;</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25004r3"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmmi-9">&#x003C;</span><span 
class="cmss-9">primitive</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">73</span><span 
class="cmmi-9">&#x003E;</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25005r4"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#8221;</span><span 
class="cmss-9">Access</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">beyond</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">fixed</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">variables</span><span 
class="cmss-9">.&#8221;</span><span 
class="cmss-9">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25006r5"></a></span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">&#x02C6;</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">basicAt</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">index</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">-</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">self</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">class</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">instSize</span>
   
   </div>
<!--l. 565--><p class="indent" >   The pragma&#8217;s selector is <span 
class="cmss-10">primitive: </span>and its argument is an
immediate literal value, <span 
class="cmss-10">73</span>. Each of Smalltalk&#8217;s primitives is associated
with an index, in this case <span 
class="cmss-10">73 </span>is the index for the primitive <span 
class="cmss-10">Object</span>
<span 
class="cmss-10">instVarAt:</span><span class="footnote-mark"><a 
href="#fn13x0"><sup class="textsuperscript">13</sup></a></span><a 
 id="x1-25007f13"></a> .
Typically, the code after the primitive invocation is not executed. It is executed only
if the primitive fails. In this specific case, if we try to access a variable that does not
exist, then the code following the primitive will be tried.
<!--l. 568--><p class="indent" >   As instances of the class <span 
class="cmss-10">Pragma</span>, pragmas are first class objects. A compiled
method answers to the message <span 
class="cmss-10">pragmas</span>. This method returns an array of
pragmas:
   <!--l. 570-->
   <div class="lstlisting" id="listing-44"><span class="label"><a 
 id="x1-25008r1"></a></span><span 
class="cmss-9">(</span><span 
class="cmss-9">Float</span><span 
class="cmmi-9">&#x003E;&#x003E;</span><span 
class="cmss-9">#+)</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">pragmas</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmsy-9">&#x27f6;</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">an</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">Array</span><span 
class="cmss-9">(</span><span 
class="cmmi-9">&#x003C;</span><span 
class="cmss-9">primitive</span><span 
class="cmss-9">:</span><span 
class="cmss-9">&#x00A0;</span><span 
class="cmss-9">41</span><span 
class="cmmi-9">&#x003E;</span><span 
class="cmss-9">)</span>
   
   </div>
<!--l. 574--><p class="indent" >   The method <span 
class="cmss-10">Pragma class</span><span 
class="cmmi-10">&#x003E;&#x003E;</span><span 
class="cmss-10">allNamed:in: </span>allows you to retrieve all the pragmas
with a given name inside a given class.
<!--l. 576--><p class="indent" >   Finally, a pragma knows in which method it is defined (using <span 
class="cmss-10">method</span>), the name
of the method (<span 
class="cmss-10">selector</span>), the class that contains the method (<span 
class="cmss-10">methodClass</span>), its
number of arguments (<span 
class="cmss-10">numArgs</span>), about the literals the pragma has for arguments
(<span 
class="cmss-10">hasLiteral: </span>and <span 
class="cmss-10">hasLiteralSuchThat:</span>).
   <h3 class="likesectionHead"><a 
 id="x1-260002.7"></a>References</h3>
<!--l. 1--><p class="noindent" >
   <div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XBlac09a"></a>A.&#x00A0;P.  Black,  S.&#x00A0;Ducasse,  O.&#x00A0;Nierstrasz,  D.&#x00A0;Pollet,  D.&#x00A0;Cassou,  and
   M.&#x00A0;Denker.   <span 
class="cmti-10">Pharo  by  Example</span>.   Square  Bracket  Associates,  Kehrsatz,
   Switzerland, 2009.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XDuca06b"></a>S.&#x00A0;Ducasse,  O.&#x00A0;Nierstrasz,  N.&#x00A0;Schärli,  R.&#x00A0;Wuyts,  and  A.&#x00A0;P.  Black.
   Traits:  A  mechanism  for  fine-grained  reuse.     <span 
class="cmti-10">ACM  Transactions  on</span>
   <span 
class="cmti-10">Programming Languages and Systems (TOPLAS)</span>, 28(2):331&#8211;388, Mar. 2006.
                                                                  

                                                                  
   </p>
   <p class="bibitem" ><span class="biblabel">
 [3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XGoldbergR83"></a>A.&#x00A0;Goldberg  and  D.&#x00A0;Robson.    <span 
class="cmti-10">Smalltalk-80:  The  Language  and  Its</span>
   <span 
class="cmti-10">Implementation. </span>Addison-Wesley, 1983.
</p>
   </div>
   
   <h3 class="likesectionHead"><a 
 id="x1-260002.7"></a>Notes</h3>
   <div class="footnote-text">
  <!--l. 67--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn1x0">   <sup class="textsuperscript">1</sup></a></span><span 
class="cmr-8">Please notice that Pharo&#8217;s </span><span 
class="cmti-8">protocols </span><span 
class="cmr-8">have nothing to do with constructs with the same name</span>
  <span 
class="cmr-8">in other languages (for example, Clojure&#8217;s protocols). In Pharo, a protocol just represents a</span>
  <span 
class="cmr-8">categorization of the methods of a class that helps the developer in conceptually organizing them (in</span>
  <span 
class="cmr-8">the same way that packages help in categorizing classes). There are predefined protocols (e.g.,</span>
  <span 
class="cmss-8">accessing</span><span 
class="cmr-8">, </span><span 
class="cmss-8">initialization</span><span 
class="cmr-8">, </span><span 
class="cmss-8">testing, ...</span><span 
class="cmr-8">), but you can create yours as well. Anyway, if there are only a few</span>
  <span 
class="cmr-8">methods in a class, then the extra level of hierarchy provided by protocols is not really necessary.</span>
  <span 
class="cmr-8">This is why Pharo also offers an </span><span 
class="cmssi-8">--all-- </span><span 
class="cmr-8">virtual protocol, which contains all of the methods in the</span>
  <span 
class="cmr-8">class.</span></div>

<div class="footnote-text">
  <!--l. 104--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn2x0">   <sup class="textsuperscript">2</sup></a></span><span 
class="cmr-8">Since everything in Smalltalk </span><span 
class="cmti-8">is-an </span><span 
class="cmr-8">object, these classes all inherit from </span><span 
class="cmss-8">Object</span><span 
class="cmr-8">.</span></div>

<div class="footnote-text">
  <!--l. 129--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn3x0">   <sup class="textsuperscript">3</sup></a></span><span 
class="cmr-8">Playgrounds (also called </span><span 
class="cmti-8">workspaces </span><span 
class="cmr-8">in previous releases of Pharo) are useful for</span>
  <span 
class="cmr-8">typing snippets of Smalltalk code that you would like to experiment with. Please refer</span>
  <span 
class="cmr-8">to</span><span 
class="cmr-8">&#x00A0;</span><span class="cite"><span 
class="cmr-8">[</span><a 
href="MarcoNaddeo.html#XBlac09a"><span 
class="cmr-8">1</span></a><span 
class="cmr-8">]</span></span><span 
class="cmr-8">.</span></div>

<div class="footnote-text">
  <!--l. 129--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn4x0">   <sup class="textsuperscript">4</sup></a></span><span 
class="cmr-8">Pharo avoids terms like &#8220;right mouse click&#8221; because different computers, mice, keyboards</span>
  <span 
class="cmr-8">and personal configurations mean that different users will need to press different physical buttons to</span>
  <span 
class="cmr-8">achieve the same effect. Since many users will use various modifiers keys (</span><span 
class="cmti-8">control</span><span 
class="cmr-8">, </span><span 
class="cmti-8">ALT</span><span 
class="cmr-8">, </span><span 
class="cmti-8">meta </span><span 
class="cmr-8">etc.) to</span>
  <span 
class="cmr-8">achieve the same effect, Pharo instead uses the term </span><span 
class="cmti-8">action-click </span><span 
class="cmr-8">to refer to the mouse button that is</span>
  <span 
class="cmr-8">used to bring up a contextual menu, that is, a menu that offers different sets of actions</span>
  <span 
class="cmr-8">depending on where the mouse is pointing; usually, this corresponds to the right button of the</span>
  <span 
class="cmr-8">mouse. Pharo defines two other kinds of clicks, </span><span 
class="cmti-8">click </span><span 
class="cmr-8">and </span><span 
class="cmti-8">meta-click</span><span 
class="cmr-8">; please refer to</span><span 
class="cmr-8">&#x00A0;</span><span class="cite"><span 
class="cmr-8">[</span><a 
href="MarcoNaddeo.html#XBlac09a"><span 
class="cmr-8">1</span></a><span 
class="cmr-8">]</span></span> <span 
class="cmr-8">for</span>
  <span 
class="cmr-8">details.</span></div>

<div class="footnote-text">
  <!--l. 340--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn5x0">   <sup class="textsuperscript">5</sup></a></span><span 
class="cmr-8">Remember that, as we have seen in Section </span><a 
href="MarcoNaddeo.html#x1-20001"><span 
class="cmr-8">1</span><!--tex4ht:ref: sec:smalltalkobjmodel --></a><span 
class="cmr-8">, Smalltalk has no dedicated syntax to specify</span>
  <span 
class="cmr-8">that a method or a class is abstract. By convention, the body of an abstract method consists of the</span>
  <span 
class="cmr-8">expression </span><span 
class="cmss-8">self subclassResponsibility</span><span 
class="cmr-8">.</span></div>

<div class="footnote-text">
  <!--l. 400--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn6x0">   <sup class="textsuperscript">6</sup></a></span><span 
class="cmr-8">Note that we subclass </span><span 
class="cmss-8">ProtoObject </span><span 
class="cmr-8">rather than </span><span 
class="cmss-8">Object </span><span 
class="cmr-8">because we do not want our proxy to</span>
  <span 
class="cmr-8">inherit the large number of methods which are defined in </span><span 
class="cmss-8">Object</span><span 
class="cmr-8">. We implement the new class in</span>
  <span 
class="cmr-8">the category </span><span 
class="cmss-8">PBEReflection</span><span 
class="cmr-8">. Historically, in Smalltalk a </span><span 
class="cmti-8">category </span><span 
class="cmr-8">is simply a collection</span>
  <span 
class="cmr-8">of related classes. A package, instead, is a collection of related classes </span><span 
class="cmti-8">and extension</span>
  <span 
class="cmti-8">methods </span><span 
class="cmr-8">that may be versioned using Pharo&#8217;s versioning tool, which is called Monticello. An</span>
  <span 
class="cmr-8">extension method is a method implemented into an existing class, but that is put in another</span>
  <span 
class="cmr-8">package respect to the package of the class (for example, you can add methods to the</span>
  <span 
class="cmss-8">Object </span><span 
class="cmr-8">class putting them in a new package created by your own!). By convention, package</span>
  <span 
class="cmr-8">names and category names are the same; for most purposes, you can not care about the</span>
  <span 
class="cmr-8">difference, but there are points where the difference is crucial. Please refer to</span><span 
class="cmr-8">&#x00A0;</span><span class="cite"><span 
class="cmr-8">[</span><a 
href="MarcoNaddeo.html#XBlac09a"><span 
class="cmr-8">1</span></a><span 
class="cmr-8">]</span></span> <span 
class="cmr-8">for</span>
  <span 
class="cmr-8">details.</span></div>

<div class="footnote-text">
  <!--l. 425--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn7x0">   <sup class="textsuperscript">7</sup></a></span><span 
class="cmr-8">The transcript is an object that is often used for logging system messages. It is a kind of</span>
  <span 
class="cmr-8">&#8220;system console&#8221;.</span></div>

<div class="footnote-text">
  <!--l. 434--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn8x0">   <sup class="textsuperscript">8</sup></a></span><span 
class="cmr-8">This message swaps all the object pointers to the receiver and the argument: after sending</span>
  <span 
class="cmr-8">this message to a receiver </span><span 
class="cmss-8">r </span><span 
class="cmr-8">with an argument </span><span 
class="cmss-8">a</span><span 
class="cmr-8">, all variables in the entire system that used to point</span>
  <span 
class="cmr-8">to </span><span 
class="cmss-8">r </span><span 
class="cmr-8">will point to </span><span 
class="cmss-8">a</span><span 
class="cmr-8">, and vice-versa.</span></div>

<div class="footnote-text">
  <!--l. 507--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn9x0">   <sup class="textsuperscript">9</sup></a></span><span 
class="cmr-8">The messages </span><span 
class="cmss-8">flushcache</span><span 
class="cmr-8">, </span><span 
class="cmss-8">methodClass: </span><span 
class="cmr-8">and </span><span 
class="cmss-8">selector: </span><span 
class="cmr-8">may be sent to a compiled method, so</span>
  <span 
class="cmr-8">they need to be implemented by an object pretending to be a compiled method; others may be</span>
  <span 
class="cmr-8">required depending on whether the method is installed using </span><span 
class="cmss-8">Behavior</span><span 
class="cmmi-8">&#x003E;&#x003E;</span><span 
class="cmss-8">addSelector:withMethod: </span><span 
class="cmr-8">or</span>
  <span 
class="cmr-8">directly using </span><span 
class="cmss-8">MethodDictionary</span><span 
class="cmmi-8">&#x003E;&#x003E;</span><span 
class="cmss-8">at:put: </span><span 
class="cmr-8">(see later).</span></div>

<div class="footnote-text">
   <!--l. 539--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn10x0">  <sup class="textsuperscript">10</sup></a></span><span 
class="cmr-8">For example, Perl offers </span><span 
class="cmti-8">method modifiers</span><span 
class="cmr-8">, which are hooks that allow a method to be</span>
   <span 
class="cmr-8">wrapped with </span><span 
class="cmti-8">before</span><span 
class="cmr-8">, </span><span 
class="cmti-8">after </span><span 
class="cmr-8">and </span><span 
class="cmti-8">around </span><span 
class="cmr-8">method modifiers. Method modifiers can be added through</span>
   <span 
class="cmr-8">the metaclass and work by wrapping the original method and then replacing it in the class symbol</span>
   <span 
class="cmr-8">table. Every time a method is called, its modifiers are also called, in the appropriate order. The</span>
   <span 
class="cmr-8">return values of </span><span 
class="cmti-8">before </span><span 
class="cmr-8">and </span><span 
class="cmti-8">after </span><span 
class="cmr-8">modifiers are ignored because their purpose is not to filter the input</span>
   <span 
class="cmr-8">and output of the primary method: this is done with an </span><span 
class="cmti-8">around </span><span 
class="cmr-8">modifier, which allows you to change</span>
   <span 
class="cmr-8">both the parameters passed to the wrapped method (if you want to call it), as well as its return</span>
   <span 
class="cmr-8">value.</span></div>

<div class="footnote-text">
   <!--l. 539--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn11x0">  <sup class="textsuperscript">11</sup></a></span><span 
class="cmr-8">It is possible to modify the original method, using Perl&#8217;s terminology, </span><span 
class="cmti-8">around </span><span 
class="cmr-8">its invocation</span>
   <span 
class="cmr-8">as well: you can choose if calling the original method by using </span><span 
class="cmss-8">perform:withArguments:</span><span 
class="cmr-8">, and what</span>
   <span 
class="cmr-8">arguments to pass if you do so; moreover, you can obviously decide if modifying the return value of</span>
   <span 
class="cmr-8">the original method.</span></div>

<div class="footnote-text">
   <!--l. 555--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn12x0">  <sup class="textsuperscript">12</sup></a></span><span 
class="cmr-8">In Smalltalk everything is an object, and everything happens by sending messages.</span>
   <span 
class="cmr-8">Nevertheless, at certain points we hit rock bottom. Certain objects can only get work done by</span>
   <span 
class="cmr-8">invoking virtual machine primitives. For example, the following are all implemented as primitives:</span>
   <span 
class="cmr-8">memory allocation (</span><span 
class="cmss-8">new</span><span 
class="cmr-8">, </span><span 
class="cmss-8">new:</span><span 
class="cmr-8">), bit manipulation (</span><span 
class="cmss-8">bitAnd:</span><span 
class="cmr-8">, </span><span 
class="cmss-8">bitOr:</span><span 
class="cmr-8">, </span><span 
class="cmss-8">bitShift:</span><span 
class="cmr-8">), pointer and integer</span>
   <span 
class="cmr-8">arithmetic (</span><span 
class="cmss-8">+</span><span 
class="cmr-8">, , </span><span 
class="cmmi-8">&#x003C;</span><span 
class="cmr-8">, </span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8">, </span><span 
class="cmss-8">*</span><span 
class="cmr-8">, </span><span 
class="cmss-8">/</span><span 
class="cmr-8">, </span><span 
class="cmss-8">=</span><span 
class="cmr-8">, </span><span 
class="cmss-8">==</span><span 
class="cmr-8">...), and array access (</span><span 
class="cmss-8">at:</span><span 
class="cmr-8">, </span><span 
class="cmss-8">at:put:</span><span 
class="cmr-8">).</span></div>

<div class="footnote-text">
   <!--l. 566--><p class="indent" >     <span class="footnote-mark"><a 
 id="fn13x0">  <sup class="textsuperscript">13</sup></a></span><span 
class="cmr-8">For further information on primitives, see the </span><span 
class="cmti-8">Formal Specification of the Primitive Methods</span>
   <span 
class="cmr-8">chapter in the Smalltalk book</span><span 
class="cmr-8">&#x00A0;</span><span class="cite"><span 
class="cmr-8">[</span><a 
href="MarcoNaddeo.html#XGoldbergR83"><span 
class="cmr-8">3</span></a><span 
class="cmr-8">]</span></span> <span 
class="cmr-8">which contains, among other things, a table that lists all available</span>
   <span 
class="cmr-8">Smalltalk&#8217;s primitives with their associated indexes.</span></div>

<p class="indent" >
                                                                  
<!--l. 566--><p class="noindent" >
   <h3 class="likesectionHead"><a 
 id="x1-12000"></a>Copyright and Licence</h3>
This article is copyright &copy;  2015 by Marco Naddeo. Licensed under the <a href="https://creativecommons.org/licenses/by-sa/2.0/">Creative Commons Attribution-ShareAlike license 2.0 <img src="images/ccbysa.png"/></a>.
    
</body></html> 

                                                                  


