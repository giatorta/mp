<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Metaprogramming in Python</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html --> 
<meta name="src" content="casagranda_metaprogramming_in_python_r03.tex"> 
<meta name="date" content="2015-01-08 16:11:00"> 
<link rel="stylesheet" type="text/css" href="stylesheets/python.css"> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">Metaprogramming in Python</h2>
<div class="author" ><span 
class="ecrm-1200"><a href="https://github.com/casagranda">Paolo Casagranda</a>, PhD Candidate</span>
<br />  <span 
class="ecrm-1200">Universit</span><span 
class="ecrm-1200">Ã  degli Studi di Torino</span>
<br />  </div><br />
<div class="date" ><span 
class="ecrm-1200">January 8, 2015</span></div>
   </div>
<!--l. 66--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1000"></a><span 
class="ecbx-1000">Foreword</span></span>
   Meta programming allows us to write programs that manipulate other programs,
treating them as data. Some languages have also more sophisticated features,
allowing them to modify a wide area of the language itself, allowing the creation
of a Meta Object Protocol System <span class="cite">[<a 
href="#Xtorta_2014">1</a>]</span>. The following discussion describes
meta programming capabilities of Python, giving also an overview of its
built in Meta Object Protocol features. The investigation is justified by the
widespread usage of Python in production environments. Python has both the
aforementioned features built in, and we will show its power and flexibility when
meta programming is needed. In Python, metaclasses have been used for logging,
interface checking, automatic delegation, automatic property creation, proxies,
frameworks, and automatic resource locking/synchronization <span class="cite">[<a 
href="#Xpython_datamodel">2</a>]</span>. When useful,
comparisons with CLOS (the Common Lisp Object System) and Perl Moose and
(Meta Object Protocol) will be made. A good primer of Python for Lisp
programmers is on Peter Norvig&#8217;s site <span class="cite">[<a 
href="#Xpython_norvig">3</a>]</span>. We&#8217;ll show that, while lacking of Lisp&#8217;s
homoiconicity and macros, Python allows to write compact, intuitive and
powerful meta programming constructs. We&#8217;ll show also that, although meta
programming is mostly intended for module authors and not for users (e.g.
Perl MOP), Python has some facilities that are very useful for end users
too.
<!--l. 73--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-2000"></a><span 
class="ecbx-1000">Classes and Objects</span></span>
   Programming languages supporting the Meta Object Protocol allow to modify the
language itself, and they should basically have two features:
     <ul class="itemize1">
     <li class="itemize">a basic OO system
                                                                  

                                                                  
     </li>
     <li class="itemize">reflection (both introspection, i.e. language capability of analyzing itself,
     and intercession, i.e. the capability to modify itself)</li></ul>
<!--l. 79--><p class="noindent" >Python has both OO and reflective capabilities, so it supports Meta Object Protocol.
Specially, we&#8217;ll show that MOP features are built in the language. <span 
class="ecbx-1000">In Python</span>
<span 
class="ecbx-1000">everything is an object </span>(see also Figure <a 
href="#x1-20331">1<!--tex4ht:ref: fig:uml_diagram --></a>), and classes, methods and
functions are no exceptions to this rule. Objects are Python&#8217;s abstraction for
data. All data in a Python program is represented by objects or by relations
between objects <span class="cite">[<a 
href="#Xpython_datamodel">2</a>]</span>. For example, classes are objects capable of producing other
objects, and they can be assigned to variables too. Each class is implemented
using a dictionary object, that is a lookup table assigning to attributes and
methods defined in the class their definition. Class attribute references are
translated to lookups in this dictionary with the builtin method <span 
class="ectt-1000">__dict__</span>. In
a class, calling a method or referencing an attribute <span 
class="ectt-1000">C.x </span>is equivalent to
<span 
class="ectt-1000">C.__dict__["x"]</span>. When the attribute name is not found there, the attribute
search continues in the base classes. The following code shows the concept:
<!--l. 82-->
<a 
 id="x1-2001r1"></a>
<a 
 id="x1-2002"></a>
<div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-2003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">The</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">object</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">B</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">object</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">simple</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">example</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">of</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">in</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Python</span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">=2</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">=4</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">c</span><span 
class="ecrm-0800">=6</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">printme</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">c</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">c</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">The</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">callable</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">instance</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">instantiated</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">calling</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2013r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">like</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">in</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">following</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">code</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2014r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">B</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2015r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">printme</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2016r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2017r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">We</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">access</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">to</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">dictionary</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">using</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">builtin</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__dict__</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2018r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">B</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">dictionary</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2019r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">B</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">__dict__</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2020r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2021r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2022r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">c</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">2</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">4</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">6</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2023r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ecrm-0800">Class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">B</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">dictionary</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2024r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ecrm-0800">{&#8217;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">2,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2025r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">c</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">6,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2026r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">4,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2027r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__dict__</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x003C;</span><span 
class="ecrm-0800">attribute</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__dict__</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">of</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">B</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">objects</span><span 
class="ecrm-0800">&#x003E;,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2028r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__weakref__</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x003C;</span><span 
class="ecrm-0800">attribute</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__weakref__</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">of</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">B</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">objects</span><span 
class="ecrm-0800">&#x003E;,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2029r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">printme</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x003C;</span><span 
class="ecrm-0800">function</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">printme</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">at</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">0</span><span 
class="ecrm-0800">x10e977d70</span><span 
class="ecrm-0800">&#x003E;,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2030r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__module__</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__main__</span><span 
class="ecrm-0800">&#8217;,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2031r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__doc__</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">simple</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">example</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">of</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">in</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Python</span><span 
class="ecrm-0800">&#8217;}</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2032r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;1:
    </span><span  
class="content">Python&#8217;s
    class
    capabilities</span></div><!--tex4ht:label?: x1-2001r -->
   </div>
<!--l. 115--><p class="indent" >   Figure <a 
href="#x1-20331">1<!--tex4ht:ref: fig:uml_diagram --></a> shows the Class Diagram for the basic objects in Python.
<!--l. 117--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-20331"></a><a 
 id="x1-2038r6"></a><a 
 id="x1-2045r2"></a><a 
 id="x1-4001r15"></a><a 
 id="x1-5001r15"></a><a 
 id="x1-5017r27"></a><a 
 id="x1-6001r9"></a><a 
 id="x1-7001r13"></a><a 
 id="x1-7015r16"></a><a 
 id="x1-7032r12"></a><a 
 id="x1-7045r25"></a><a 
 id="x1-8001r22"></a><a 
 id="x1-8024r26"></a><a 
 id="x1-9001r19"></a><a 
 id="x1-9021r21"></a><a 
 id="x1-9043r6"></a><a 
 id="x1-9060r25"></a><a 
 id="x1-9086r9"></a><a 
 id="x1-10001r3"></a><a 
 id="x1-10005r14"></a><a 
 id="x1-13001r55"></a>
                                                                  
<img src="images/python_object_diagram.png"/>
                                                                  
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1: </span>
<span  
class="content">Python: UML Class Diagram for objects, classes and metaclasses</span></div><!--tex4ht:label?: x1-20331 -->
                                                                  

                                                                  
<!--l. 122--><p class="indent" >   </div><hr class="endfigure">
<!--l. 124--><p class="indent" >   We see that the metaclass <span 
class="ectt-1000">type </span>inherits from <span 
class="ectt-1000">object </span>(it has <span 
class="ectt-1000">object </span>as
its base class). Moreover, <span 
class="ectt-1000">object </span>has no base class. Python basic classes
generally have <span 
class="ectt-1000">object </span>as base class (the relation can be checked printing
<span 
class="ectt-1000">object.__bases__, int.__bases__, type.__bases__</span>, where <span 
class="ectt-1000">object </span>is the object
class).
<!--l. 126--><p class="indent" >   In particular, the class attribute <span 
class="ectt-1000">__bases__ </span>is used to specify the base classes of a
Python object, while Perl stores the dependencies in an @ISA array, that is global for
a package.
<!--l. 128--><p class="indent" >   <span 
class="ectt-1000">type </span>is the metaclass of most of Python basic classes: for example <span 
class="ectt-1000">int</span>, <span 
class="ectt-1000">float</span>,
<span 
class="ectt-1000">str</span>, <span 
class="ectt-1000">object </span>are instantiated from <span 
class="ectt-1000">type</span>. In the following discussion we&#8217;ll see that in
Python the metaclass can be customized.
<!--l. 130--><p class="indent" >   So, in Python, a class can be defined in the following way: <!--l. 131-->
<div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-2034r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">MonkeyWrench</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2035r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Optional</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">documentation</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">for</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">followed</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">by</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">definition</span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2036r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">pass</span>
   </div>
<!--l. 136--><p class="indent" >   The Python interpreter, behind the scenes, when a class is defined, after running
all the code in a namespace dictionary, calls <span 
class="ectt-1000">type </span>to concretely create the class
object. The call has the following syntax: <!--l. 137-->
<div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-2037r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">type</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">classname</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">superclasses</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">attributesdict</span><span 
class="ecrm-0800">)</span>
   </div>
<!--l. 140--><p class="indent" >   Objects and classes can be modified at run-time: this feature enables to
dynamically create classes, methods, functions and dynamically alter their behavior.
In Perl, to create a class meta-object we use Class::MOP::Class, in the following way:
<!--l. 142-->
<a 
 id="x1-2038r2"></a>
<a 
 id="x1-2039"></a>
<div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-2040r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">use</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Class</span><span 
class="ecrm-0800">::</span><span 
class="ecrm-0800">MOP</span><span 
class="ecrm-0800">;</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2041r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">my</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">$class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Class</span><span 
class="ecrm-0800">::</span><span 
class="ecrm-0800">MOP</span><span 
class="ecrm-0800">::</span><span 
class="ecrm-0800">Class</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">create</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2042r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">Monkey</span><span 
class="ecrm-0800">::</span><span 
class="ecrm-0800">Wrench</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">superclasses</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=&#x003E;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">[...],</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">attributes</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=&#x003E;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">[</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2043r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">Class</span><span 
class="ecrm-0800">::</span><span 
class="ecrm-0800">MOP</span><span 
class="ecrm-0800">::</span><span 
class="ecrm-0800">Attribute</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">new</span><span 
class="ecrm-0800">(...)</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">...],</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">methods</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=&#x003E;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-2044r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">...</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">;</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;2:
    </span><span  
class="content">Class
    in
    Perl
    MOP</span></div><!--tex4ht:label?: x1-2038r -->
   </div>
<!--l. 149--><p class="indent" >   Python has built in metaclass handling, very similar to Perl&#8217;s Class::MOP::Class,
and yet more compact. Python&#8217;s <span 
class="ectt-1000">type </span>is used to create classes, in the following way:
<!--l. 150-->
<a 
 id="x1-2045r3"></a>
<a 
 id="x1-2046"></a>
<div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-2047r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">MonkeyWrench</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">type</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">MonkeyWrench</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,()</span><span 
class="ecrm-0800">,{})</span>
                                                                  

                                                                  
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;3:
    </span><span  
class="content">Class
    in
    Python</span></div><!--tex4ht:label?: x1-2045r -->
   </div>
<!--l. 156--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-3000"></a><span 
class="ecbx-1000">Creating instances</span></span>
   When a class is instantiated, behind the scenes <span 
class="ectt-1000">type </span>is used to create the object.
The process of creating an instance can be described by the following sequence of
operations:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1000">B=type(classname, superclasses, attributedict)</span>
     </li>
     <li class="itemize">the  <span 
class="ectt-1000">__call__ </span>method  of  <span 
class="ectt-1000">type </span>is  then  called,  which  in  turn  calls  two
     methods:
     </li>
     <li class="itemize"><span 
class="ectt-1000">type.__new__(typeclass, classname, superclasses,</span>
     <span 
class="ectt-1000">attributedict) </span>returns the new object
     </li>
     <li class="itemize"><span 
class="ectt-1000">type.__init__(class, classname, superclasses, attributedict)</span>
     initializes the new object</li></ul>
<!--l. 165--><p class="indent" >   <span 
class="ectt-1000">type </span>inherits from <span 
class="ectt-1000">object</span>, because it&#8217;s an object itself. Both <span 
class="ectt-1000">type </span>and <span 
class="ectt-1000">object</span>
are of type <span 
class="ectt-1000">type</span>, and both <span 
class="ectt-1000">type </span>and <span 
class="ectt-1000">object </span>are subclasses of <span 
class="ectt-1000">object</span>.
<!--l. 168--><p class="indent" >   In the following discussion, results have been extensively checked with builtin
Python functions <span 
class="ectt-1000">isinstance( object_to_be_checked, class )</span>, <span 
class="ectt-1000">issubclass(</span>
<span 
class="ectt-1000">class_to_be_checked, class )</span>, <span 
class="ectt-1000">type( object )</span>. These methods help
understanding the underlying structure of classes and objects.
<!--l. 170--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-4000"></a><span 
class="ecbx-1000">Callable instances</span></span>
   In Python, methods, functions and class instances that define the <span 
class="ectt-1000">__call__</span>
method are callable. The <span 
class="ectt-1000">__call__ </span>method implementation allows an instance to
be called like a function as well. Callable instances are similar to CLisp
funcallable class instances and are easily defined as the following example clarifies:
<!--l. 172-->
<a 
 id="x1-4001r4"></a>
<a 
 id="x1-4002"></a>
<div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-4003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">funcallable</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">instance</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">example</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">in</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">CLisp</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">similar</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">behavior</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">implies</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">use</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">of</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">funcallable</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">standard</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">CallMe</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">object</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__call__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">test</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">test</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">callme</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">CallMe</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">callme</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">I</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">m</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">calling</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">you</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4013r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4014r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4015r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">I</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">m</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">calling</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">you</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-4016r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">"""</span>
                                                                  

                                                                  
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;4:
    </span><span  
class="content">Callable
    instances</span></div><!--tex4ht:label?: x1-4001r -->
   </div>
<!--l. 189--><p class="indent" >   In CLisp an instance is funcallable if its class is itself an instance of the class
<span 
class="ectt-1000">funcallable_standard_class </span>or of one of its subclasses.
<!--l. 191--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-5000"></a><span 
class="ecbx-1000">Dynamic method handling: classes and objects</span></span>
   In Python, methods and functions are objects too. It&#8217; possible to add
a method to a class, so that every instantiated object has that method.
<!--l. 193-->
<a 
 id="x1-5001r5"></a>
<a 
 id="x1-5002"></a>
<div class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-5003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">object</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__init__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">developing</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">p1</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Paolo</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5013r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">p1</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5014r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5015r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">p2</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Maryam</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5016r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">p2</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">()</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;5:
    </span><span  
class="content">Dynamically
    adding
    new
    method
    to
    a
    class</span></div><!--tex4ht:label?: x1-5001r -->
   </div>
<!--l. 209--><p class="indent" >   The dynamically defined method "develop" belongs to class Person, so to all
instantiated objects. Note that like in Perl, a new method dynamically added to a
class is also immediately active on all already instantiated objects.
<!--l. 211--><p class="indent" >   It&#8217;s also possible to dynamically add a method to a <span 
class="ecti-1000">single object</span>, using the
<span 
class="ectt-1000">MethodType </span>class of the <span 
class="ectt-1000">types </span>module. <!--l. 212-->
<a 
 id="x1-5017r6"></a>
<a 
 id="x1-5018"></a>
<div class="lstlisting" id="listing-8"><span class="label"><a 
 id="x1-5019r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">from</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">types</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">import</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">MethodType</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5020r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5021r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">object</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5022r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__init__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5023r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5024r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5025r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5026r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">developing</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5027r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5028r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">po1</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Paolo</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5029r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">po1</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">MethodType</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">po1</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5030r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">po1</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">?</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">isinstance</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">po1</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5031r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">po1</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5032r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">po2</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Andrea</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5033r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">po2</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">?</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">isinstance</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">po2</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5034r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ecrm-0800">try</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5035r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">po2</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">throwing</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">an</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">exception</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5036r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ecrm-0800">except</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5037r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">po2</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">has</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">no</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">method</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5038r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5039r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5040r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ecrm-0800">po1</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">?</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">True</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5041r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ecrm-0800">Paolo</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">developing</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5042r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ecrm-0800">po2</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Person</span><span 
class="ecrm-0800">?</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">True</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5043r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ecrm-0800">po2</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">has</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">no</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">develop</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">method</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-5044r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;6:
    </span><span  
class="content">Dynamically
    adding
    new
    method
    to
    a
    single
    object</span></div><!--tex4ht:label?: x1-5017r -->
                                                                  

                                                                  
   </div>
<!--l. 241--><p class="indent" >   The dynamically defined method "develop" only belongs to object po1, not to
po2.
<!--l. 244--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-6000"></a><span 
class="ecbx-1000">Python has no macros</span></span>
   Python doesn&#8217;t natively support macros like Lisp, and Python&#8217;s abstract syntax
tree (AST) is much less intuitive than Lisp&#8217;s, although accessible indeed (see previous
discussion). Moreover, Python lacks <span 
class="ecbx-1000">homoiconicity</span>, that is a language property to
have very similar syntax and internal program representation. If the language
provides both homoiconicity and access to the AST, modification of the language
AST can be easy and intuitive (see also next chapter about dynamic code
generation). In Python, language syntax and AST structure are very different, so,
while AST access and modification are supported, they are somehow more difficult to
perform.
<!--l. 246--><p class="indent" >   It is still possible to create something similar to macros using strings
operations, but it is not integrated with the rest of the language <span class="cite">[<a 
href="#Xpython_norvig">3</a>]</span>. On the
other hand there are third party libraries allowing to achieve part of this
functionality. For example, MacroPy is a package allowing syntactic macros in
Python <span class="cite">[<a 
href="#Xmacropy">6</a>]</span>. MacroPy provides a mechanism to define macros performing
transformations on the abstract syntax tree (AST) of a Python program at
import time. The following example illustrates one feature of the package:
<!--l. 247-->
<a 
 id="x1-6001r7"></a>
<a 
 id="x1-6002"></a>
<div class="lstlisting" id="listing-9"><span class="label"><a 
 id="x1-6003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">from</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">macropy</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">string_interp</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">import</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">macros</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-6004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-6005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Linus</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Peter</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-6006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">[</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">{</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">}</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">and</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">}</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">like</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">meta</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">programming</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">]</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-6007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-6008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-6009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">Linus</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">and</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Peter</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">like</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">meta</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">programming</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-6010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;7:
    </span><span  
class="content">MacroPy:
    simple
    string
    interpolation
    example</span></div><!--tex4ht:label?: x1-6001r -->
   </div>
<!--l. 258--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-7000"></a><span 
class="ecbx-1000">Dynamic code generation: </span><span 
class="ectt-1000">compile</span><span 
class="ecbx-1000">, </span><span 
class="ectt-1000">exec</span><span 
class="ecbx-1000">, </span><span 
class="ectt-1000">ast</span></span>
   Python lacks Lisp&#8217;s homoiconicity, macros and syntax-quote, but still allows
to obtain similar results. Code can manipulate other code using strings or
the more complex and subtle syntax of the Abstract Syntax Trees. The
<span 
class="ectt-1000">compile </span>command allows to dynamically create code to be used in the current
program by means of the <span 
class="ectt-1000">exec </span>command, given a namespace. An example
below:
   <!--l. 262-->
                                                                  

                                                                  
<a 
 id="x1-7001r8"></a>
<a 
 id="x1-7002"></a>
<div class="lstlisting" id="listing-10"><span class="label"><a 
 id="x1-7003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">dynamically</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">generate</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">code</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">mycode</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">test</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Hallo</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">",</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">code</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">compile</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">mycode</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">&#x003C;</span><span 
class="ecrm-0800">string</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">exec</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">ns</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{}</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">exec</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">code</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">in</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ns</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">ns</span><span 
class="ecrm-0800">[</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">test</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">](</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Paolo</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7013r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">Hallo</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Paolo</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7014r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;8:
    </span><span  
class="content">Dynamic
    code
    generation</span></div><!--tex4ht:label?: x1-7001r -->
   </div>
<!--l. 277--><p class="indent" >   The source in the string <span 
class="ectt-1000">mycode </span>is dynamically included in the program. However,
this example evidences that no syntax check will be done to <span 
class="ectt-1000">mycode </span>at compile time,
because it&#8217;s a string. A more consistent despite harder way to dynamically create
code is to directly build an AST using the <span 
class="ectt-1000">ast </span>module. Python can easily analyse the
AST of a source code: <!--l. 279-->
<a 
 id="x1-7015r9"></a>
<a 
 id="x1-7016"></a>
<div class="lstlisting" id="listing-11"><span class="label"><a 
 id="x1-7017r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">analysing</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">an</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">AST</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7018r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">import</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ast</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7019r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ast</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">dump</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">ast</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">parse</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">mycode</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">True</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">True</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7020r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7021r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7022r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">Module</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">body</span><span 
class="ecrm-0800">=[</span><span 
class="ecrm-0800">FunctionDef</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">=&#8217;</span><span 
class="ecrm-0800">test</span><span 
class="ecrm-0800">&#8217;,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7023r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">arguments</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">=[</span><span 
class="ecrm-0800">Name</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">id</span><span 
class="ecrm-0800">=&#8217;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#8217;,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ctx</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">Param</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7024r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">lineno</span><span 
class="ecrm-0800">=1,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">col_offset</span><span 
class="ecrm-0800">=9)</span><span 
class="ecrm-0800">],</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7025r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">vararg</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">None</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">kwarg</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">None</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">defaults</span><span 
class="ecrm-0800">=[])</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7026r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">body</span><span 
class="ecrm-0800">=[</span><span 
class="ecrm-0800">Print</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">dest</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">None</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">values</span><span 
class="ecrm-0800">=[</span><span 
class="ecrm-0800">Str</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">=&#8217;</span><span 
class="ecrm-0800">Hello</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7027r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">lineno</span><span 
class="ecrm-0800">=2,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">col_offset</span><span 
class="ecrm-0800">=10)</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Name</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">id</span><span 
class="ecrm-0800">=&#8217;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#8217;,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ctx</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">Load</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7028r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">lineno</span><span 
class="ecrm-0800">=2,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">col_offset</span><span 
class="ecrm-0800">=20)</span><span 
class="ecrm-0800">],</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">nl</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">True</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">lineno</span><span 
class="ecrm-0800">=2,</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7029r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">col_offset</span><span 
class="ecrm-0800">=4)</span><span 
class="ecrm-0800">],</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">decorator_list</span><span 
class="ecrm-0800">=[],</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7030r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">lineno</span><span 
class="ecrm-0800">=1,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">col_offset</span><span 
class="ecrm-0800">=0)</span><span 
class="ecrm-0800">])</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7031r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;9:
    </span><span  
class="content">Analysing
    the
    AST</span></div><!--tex4ht:label?: x1-7015r -->
   </div>
<!--l. 297--><p class="indent" >   The <span 
class="ectt-1000">ast.parse </span>helper allows to create the AST from the source code. Then,
<span 
class="ectt-1000">ast.dump </span>transforms it into human readable text. The next step is dynamically
creating code ready for execution using the AST. The <span 
class="ectt-1000">ast.Module </span>and other classes
will help building it, however the operation is somehow verbose, as the following
simple example will show:
   <!--l. 300-->
<a 
 id="x1-7032r10"></a>
<a 
 id="x1-7033"></a>
<div class="lstlisting" id="listing-12"><span class="label"><a 
 id="x1-7034r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">creating</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">an</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">AST</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7035r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">from</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ast</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">import</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7036r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">tree</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Module</span><span 
class="ecrm-0800">([</span><span 
class="ecrm-0800">Print</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">None</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">[</span><span 
class="ecrm-0800">Str</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Hello</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">World</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">],</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">True</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">])</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7037r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">tree</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">lineno</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">1</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7038r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">tree</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">col_offset</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">1</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7039r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">tree</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fix_missing_locations</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">tree</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7040r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">exec</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">compile</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">tree</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x003C;</span><span 
class="ecrm-0800">string</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">exec</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7041r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7042r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7043r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">Hello</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">World</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7044r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;10:
    </span><span  
class="content">Building
    an
    AST</span></div><!--tex4ht:label?: x1-7032r -->
   </div>
<!--l. 314--><p class="indent" >   As the syntax tree can be analysed and created, it can also be modified, using
<span 
class="ectt-1000">ast.transformer</span>. This class allows for example to catch the nodes of the AST and
modify them:
   <!--l. 316-->
                                                                  

                                                                  
<a 
 id="x1-7045r11"></a>
<a 
 id="x1-7046"></a>
<div class="lstlisting" id="listing-13"><span class="label"><a 
 id="x1-7047r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">modifying</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">an</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">AST</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">example</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7048r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">from</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ast</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">import</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7049r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7050r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">define</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">function</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">add</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">+</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7051r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">tree2</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Module</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">body</span><span 
class="ecrm-0800">=[</span><span 
class="ecrm-0800">FunctionDef</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">myadd</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">arguments</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">=[</span><span 
class="ecrm-0800">Name</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">id</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ctx</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">Param</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Name</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">id</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ctx</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">Param</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">],</span><span 
class="ecrm-0800">vararg</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">None</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">kwarg</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">None</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">defaults</span><span 
class="ecrm-0800">=[])</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">body</span><span 
class="ecrm-0800">=[</span><span 
class="ecrm-0800">Return</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">value</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">BinOp</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">left</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">Name</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">id</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ctx</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">Load</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">op</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">Add</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">right</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">Name</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">id</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ctx</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">Load</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">],</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">decorator_list</span><span 
class="ecrm-0800">=[])</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">])</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7052r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">tree2</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">fix_missing_locations</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">tree2</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7053r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">exec</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">compile</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">tree2</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x003C;</span><span 
class="ecrm-0800">string</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">exec</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7054r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">myadd</span><span 
class="ecrm-0800">(7,8)</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">myadd</span><span 
class="ecrm-0800">(7,8)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7055r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7056r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">modify</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ast</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7057r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">MyNodeTransformer</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">ast</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">NodeTransformer</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7058r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">visit_BinOp</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">node</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7059r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">node</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">op</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ast</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">Sub</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7060r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">node</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7061r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7062r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ecrm-0800">transf</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">MyNodeTransformer</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">addition</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">becomes</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">subtraction</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7063r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ecrm-0800">newtree</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">transf</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">visit</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">tree2</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7064r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ecrm-0800">exec</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">compile</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">newtree</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x003C;</span><span 
class="ecrm-0800">string</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">exec</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7065r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">myadd</span><span 
class="ecrm-0800">(7,8)</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">myadd</span><span 
class="ecrm-0800">(7,8)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7066r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7067r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7068r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ecrm-0800">myadd</span><span 
class="ecrm-0800">(7,8)</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">15</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7069r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ecrm-0800">myadd</span><span 
class="ecrm-0800">(7,8)</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">1</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7070r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;11:
    </span><span  
class="content">Modifying
    an
    AST</span></div><!--tex4ht:label?: x1-7045r -->
   </div>
<!--l. 343--><p class="indent" >   The syntax tree can be created, modified and executed, using the complex syntax
of the <span 
class="ectt-1000">ast </span>module.
<!--l. 345--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-8000"></a><span 
class="ecbx-1000">Metaclasses</span></span>
   We&#8217;ve seen that <span 
class="ectt-1000">type </span>object allows to dynamically create classes. If we want to
exactly control how the class is created, we have to use a custom metaclass. Python
2.x has native metaclass handling by means of the <span 
class="ectt-1000">__metaclass__ </span>builtin attribute,
while Python 3.x uses the key <span 
class="ectt-1000">metaclass </span>after the declaration of the class bases:
<span 
class="ectt-1000">class Myclass(object, metaclass=Mymeta)</span>. Python, when creating the
class, will look for the <span 
class="ectt-1000">__metaclass__ </span>using this hierarchy, using the first
found:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1000">__metaclass__ </span>in the class definition, if existing
     </li>
     <li class="itemize">otherwise, if there&#8217;s at least one base class, its <span 
class="ectt-1000">__metaclass__ </span>is used
     </li>
     <li class="itemize">otherwise, the global <span 
class="ectt-1000">__metaclass__ </span>in the active module is used
     </li>
     <li class="itemize">otherwise, <span 
class="ectt-1000">type </span>is used</li></ul>
<!--l. 353--><p class="noindent" >When a class is created, Python looks for the <span 
class="ectt-1000">__metaclass__ </span>attribute, that can be a
callable (function or class). This allows classes or functions to be written which
monitor or alter the class creation process. The example below shows how the <span 
class="ectt-1000">new</span>
operator can be modified: <!--l. 355-->
<a 
 id="x1-8001r12"></a>
<a 
 id="x1-8002"></a>
<div class="lstlisting" id="listing-14"><span class="label"><a 
 id="x1-8003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">metaclass</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">used</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">to</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">modify</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">creation</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">object</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__init__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__init__</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__metaclass__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">type</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">modify</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">new</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">method</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__new__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">mcs</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">bases</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">attributes</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">cls</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">type</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">__new__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">mcs</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">bases</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">attributes</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">I</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">ve</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">created</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">bases</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">attributes</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">cls</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8013r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8014r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">B</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8015r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">pass</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8016r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8017r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">B</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8018r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8019r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8020r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ecrm-0800">I</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">ve</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">created</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(&#x003C;</span><span 
class="ecrm-0800">type</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">object</span><span 
class="ecrm-0800">&#8217;&#x003E;,)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{&#8217;</span><span 
class="ecrm-0800">__module__</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__main__</span><span 
class="ecrm-0800">&#8217;,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__metaclass__</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x003C;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__main__</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">__metaclass__</span><span 
class="ecrm-0800">&#8217;&#x003E;,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__init__</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x003C;</span><span 
class="ecrm-0800">function</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__init__</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">at</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">0</span><span 
class="ecrm-0800">x10e97db90</span><span 
class="ecrm-0800">&#x003E;}</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8021r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ecrm-0800">I</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">ve</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">created</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">B</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(&#x003C;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__main__</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">&#8217;&#x003E;,)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{&#8217;</span><span 
class="ecrm-0800">__module__</span><span 
class="ecrm-0800">&#8217;:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">__main__</span><span 
class="ecrm-0800">&#8217;}</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8022r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__init__</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8023r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;12:
    </span><span  
class="content">metaclasses
    in
    Python
    2.x</span></div><!--tex4ht:label?: x1-8001r -->
                                                                  

                                                                  
   </div>
<!--l. 379--><p class="indent" >   The script logs the call to the metaclass <span 
class="ectt-1000">__new__ </span>method, printing the class
name, the base classes and attributes. As the script runs, the class <span 
class="ectt-1000">A </span>is defined (and
the first message is printed), the class <span 
class="ectt-1000">B </span>is defined (and its message is printed) and,
finally, object <span 
class="ectt-1000">b </span>is instantiated (and the <span 
class="ectt-1000">__init__ </span>method is called). There are a few
fundamental methods available in metaclasses:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1000">__new__ </span>is called when a new <span 
class="ecbx-1000">class </span>is going to be created
     </li>
     <li class="itemize"><span 
class="ectt-1000">__init__ </span>is called when the new class has to be initialized
     </li>
     <li class="itemize"><span 
class="ectt-1000">__call__ </span>is called when a new <span 
class="ecbx-1000">instance </span>is created</li></ul>
<!--l. 387--><p class="indent" >   Latest versions of Python (from version 3) allow to use a cleaner syntax.
The following example outlines how the order of the methods can be kept:
<!--l. 388-->
<a 
 id="x1-8024r13"></a>
<a 
 id="x1-8025"></a>
<div class="lstlisting" id="listing-15"><span class="label"><a 
 id="x1-8026r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">metaclasses</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">in</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Python</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">3.</span><span 
class="ecrm-0800">x</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">taken</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">from</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">dataclass</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">model</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8027r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8028r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">instantiate</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">metaclass</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">object</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8029r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">OrderedClass</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">type</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8030r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">@classmethod</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">method</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">when</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">called</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">not</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">already</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">instantiated</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8031r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__prepare__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">metacls</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">bases</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">**</span><span 
class="ecrm-0800">kwds</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8032r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">collections</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">OrderedDict</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8033r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8034r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__new__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">cls</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">bases</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">namespace</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">**</span><span 
class="ecrm-0800">kwds</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8035r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">result</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">type</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">__new__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">cls</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">bases</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">dict</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">namespace</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8036r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">result</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">members</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">tuple</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">namespace</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">tuple</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">an</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">immutable</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">list</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8037r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">result</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8038r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8039r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">instantiate</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">object</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8040r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">metaclass</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">OrderedClass</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8041r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">one</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">pass</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8042r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">two</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">pass</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8043r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">three</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">pass</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8044r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">four</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">pass</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8045r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8046r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">check</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">the</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">members</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">order</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8047r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ecrm-0800">A</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">members</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8048r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8049r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ecrm-0800">(&#8217;</span><span 
class="ecrm-0800">__module__</span><span 
class="ecrm-0800">&#8217;,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">one</span><span 
class="ecrm-0800">&#8217;,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">two</span><span 
class="ecrm-0800">&#8217;,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">three</span><span 
class="ecrm-0800">&#8217;,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">four</span><span 
class="ecrm-0800">&#8217;)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-8050r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;13:
    </span><span  
class="content">metaclasses
    in
    Python
    3.x</span></div><!--tex4ht:label?: x1-8024r -->
   </div>
<!--l. 416--><p class="indent" >   The <span 
class="ectt-1000">__prepare__ </span>method is called before the class object is instantiated, and
returns the namespace of the class. In this case the namespace is not a normal
dictionary but an ordered dictionary, recording the order in which the methods are
created. In the code <span 
class="ectt-1000">@classmethod </span>is used: this is a decorator, syntactic sugar for
higher order functions (see next chapter for the definition).
<!--l. 419--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-9000"></a><span 
class="ecbx-1000">Decorators</span></span>
   Decorators are special higher order functions. Decorators can achieve the results
of Perl Moose before/around/after modifiers, however they are more general. They
are often used in production projects and in several Python frameworks (e.g.
Django). A decorator is a callable that takes a function as an argument and returns
another function. The <span 
class="ectt-1000">@ </span>sign applied before a callable simply tells the interpreter to
apply it to the following function. Note that although the <span 
class="ectt-1000">@ </span>sign and the
decorator&#8217;s position before methods and classes, decorators are substantially
different from Java annotations, used to include metadata, specially for the
compiler. Python 3 includes a new syntax to annotate functions including
                                                                  

                                                                  
metadata, called "function annotation", it will be introduced in the next chapter.
The language features allowing decorators are mainly the object nature of
functions and the support for <span 
class="ecti-1000">function closures </span>(inner functions defined in
non-global scope can use the namespace created at definition time, in this
case the function name). We can make a parallel with Perl Moose, where
before/around/after are used. For example, we want to print a message
before a third party defined function. The Perl Moose package allows it:
<!--l. 425-->
<a 
 id="x1-9001r14"></a>
<a 
 id="x1-9002"></a>
<div class="lstlisting" id="listing-16"><span class="label"><a 
 id="x1-9003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">package</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Example</span><span 
class="ecrm-0800">;</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">use</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Moose</span><span 
class="ecrm-0800">;</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">sub</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">hello</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Hello</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Paolo</span><span 
class="ecrm-0800">\</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">;</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">}</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">before</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">hello</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=&#x003E;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">sub</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Before</span><span 
class="ecrm-0800">\</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">};</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">after</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">hello</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=&#x003E;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">sub</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">After</span><span 
class="ecrm-0800">\</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">};</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9013r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9014r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">Example</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">new</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">hello</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9015r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9016r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9017r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ecrm-0800">Before</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9018r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ecrm-0800">Hello</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Paolo</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9019r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ecrm-0800">After</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9020r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;14:
    </span><span  
class="content">Perl
    before/around/after</span></div><!--tex4ht:label?: x1-9001r -->
   </div>
<!--l. 446--><p class="indent" >   Perl Moose around modifier is very similar to Python decorators, as it allows to
run code before the function execution, modifying the arguments, and also after
it.
<!--l. 448--><p class="indent" >   A Python decorator concisely defines a function wrapper, the following has the
same functionality as the Perl snippet: <!--l. 449-->
<a 
 id="x1-9021r15"></a>
<a 
 id="x1-9022"></a>
<div class="lstlisting" id="listing-17"><span class="label"><a 
 id="x1-9023r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">simple</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">decorator</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">doing</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">processing</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">before</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">and</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">after</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">function</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9024r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">before_and_after</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">f</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9025r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">inner</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9026r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Before</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9027r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">result</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">f</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9028r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">After</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9029r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">result</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9030r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">inner</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9031r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9032r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">@before_and_after</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9033r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">hello</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9034r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Hello</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9035r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9036r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">hello</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Paolo</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9037r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9038r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9039r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ecrm-0800">Before</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9040r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ecrm-0800">Hello</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Paolo</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9041r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ecrm-0800">After</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9042r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;15:
    </span><span  
class="content">Python
    decorators</span></div><!--tex4ht:label?: x1-9021r -->
   </div>
<!--l. 472--><p class="indent" >   Python allows also to specify that a function can be called with an arbitrary
number of arguments, wrapped in a tuple. So, being mylist a tuple, we can write
<span 
class="ectt-1000">add(mylist[0],mylist[1]) </span>or <span 
class="ectt-1000">add(*mylist)</span>. The argument list can also be a
dictionary, called **kwargs, with items labeled by keywords:
   <!--l. 474-->
<a 
 id="x1-9043r16"></a>
<a 
 id="x1-9044"></a>
<div class="lstlisting" id="listing-18"><span class="label"><a 
 id="x1-9045r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">logger</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">func</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9046r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">inner</span><span 
class="ecrm-0800">(</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">**</span><span 
class="ecrm-0800">kwargs</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">1</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9047r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">Arguments</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">were</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">kwargs</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9048r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">func</span><span 
class="ecrm-0800">(</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">**</span><span 
class="ecrm-0800">kwargs</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">2</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9049r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">inner</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;16:
    </span><span  
class="content">Python
    decorators</span></div><!--tex4ht:label?: x1-9043r -->
                                                                  

                                                                  
   </div>
<!--l. 481--><p class="indent" >   The defined decorator can be used in the following way: <!--l. 482-->
<div class="lstlisting" id="listing-19"><span class="label"><a 
 id="x1-9050r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">@logger</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9051r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">multiply</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">x</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">y</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9052r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">x</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">y</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9053r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9054r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">multiply</span><span 
class="ecrm-0800">(3,4)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9055r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9056r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9057r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">Arguments</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">were</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(3,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">4)</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{}</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9058r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">12</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9059r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">"""</span>
   </div>
<!--l. 495--><p class="indent" >   One application of decorators is function arguments validation, as in the following
example: <!--l. 496-->
<a 
 id="x1-9060r17"></a>
<a 
 id="x1-9061"></a>
<div class="lstlisting" id="listing-20"><span class="label"><a 
 id="x1-9062r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">validate</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">function</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">input</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">from</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">StackOverflow</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9063r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">accepts</span><span 
class="ecrm-0800">(</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">types</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9064r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">check_accepts</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">f</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9065r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">assert</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">len</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">types</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">==</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">f</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">func_code</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">co_argcount</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9066r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">new_f</span><span 
class="ecrm-0800">(</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">**</span><span 
class="ecrm-0800">kwds</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9067r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">for</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">t</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">in</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">zip</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">types</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9068r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">assert</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">isinstance</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">t</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">arg</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">r</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">does</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">not</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">match</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">s</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">t</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9069r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">f</span><span 
class="ecrm-0800">(</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">**</span><span 
class="ecrm-0800">kwds</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9070r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">new_f</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">func_name</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">f</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">func_name</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9071r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">new_f</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9072r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">check_accepts</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9073r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9074r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">@accepts</span><span 
class="ecrm-0800">((</span><span 
class="ecrm-0800">int</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">float</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">int</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">float</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9075r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">mult</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">arg1</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">arg2</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9076r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">arg1</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">arg2</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9077r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9078r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">mult</span><span 
class="ecrm-0800">(2.0,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">2.0)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">6</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9079r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">mult</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">2</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">2)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">AssertionError</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9080r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9081r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9082r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ecrm-0800">6.0</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9083r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ecrm-0800">[...]</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9084r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ecrm-0800">AssertionError</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">arg</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;2&#8217;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">does</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">not</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">match</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x003C;</span><span 
class="ecrm-0800">type</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">int</span><span 
class="ecrm-0800">&#8217;&#x003E;</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9085r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;17:
    </span><span  
class="content">Arguments
    validation
    with
    decorators</span></div><!--tex4ht:label?: x1-9060r -->
   </div>
<!--l. 523--><p class="indent" >   Decorators can also modify class behavior, so they can be used instead of
metaclasses in most cases. <span 
class="ecbx-1000">Class decorators </span>take the class name in input, and
return the decorated class, with the same name. In the following example, decorators
can set constraints on attributes (note that there&#8217;s actually a function returning a
decorator, as class decorators have only one argument, the class name):
<!--l. 525-->
<a 
 id="x1-9086r18"></a>
<a 
 id="x1-9087"></a>
<div class="lstlisting" id="listing-21"><span class="label"><a 
 id="x1-9088r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">@ValidString</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">empty_allowed</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">False</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9089r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">@ValidNumber</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">price</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">minimum</span><span 
class="ecrm-0800">=0,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">maximum</span><span 
class="ecrm-0800">=100000)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9090r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">@ValidNumber</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">quantity</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">minimum</span><span 
class="ecrm-0800">=1,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">maximum</span><span 
class="ecrm-0800">=1000)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9091r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">class</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">StockItem</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9092r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">__init__</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">price</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">quantity</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9093r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9094r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">price</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">price</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-9095r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">self</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">quantity</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">quantity</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;18:
    </span><span  
class="content">Arguments
    validation
    with
    decorators</span></div><!--tex4ht:label?: x1-9086r -->
   </div>
<!--l. 536--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-10000"></a><span 
class="ecbx-1000">Function annotations</span></span>
   Python 3 has a new type of syntax for adding arbitrary metadata annotations to
python function (see PEP 3107 <span class="cite">[<a 
href="#Xannotations">7</a>]</span>). Function annotations are optional and can be
used to annotate function and methods parameters and return values, associating
arbitrary Python expressions to them at compile time. So the metadata can be used
by third party libraries.
<!--l. 539--><p class="indent" >   Basically, the syntax for annotations is the following: <!--l. 540-->
                                                                  

                                                                  
<a 
 id="x1-10001r19"></a>
<a 
 id="x1-10002"></a>
<div class="lstlisting" id="listing-22"><span class="label"><a 
 id="x1-10003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">foo</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">expression</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">b</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">expression</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">5)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">expression</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">...</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;19:
    </span><span  
class="content">Function
    annotations</span></div><!--tex4ht:label?: x1-10001r -->
   </div>
<!--l. 545--><p class="indent" >   Once compiled, the annotations can be accessed by using the dictionary
<span 
class="ectt-1000">func_annotations</span>. There are several use cases, the following example uses
annotations to type check function parameters. The actual type check is performed
by the <span 
class="ectt-1000">@typecheck </span>decorator using the metadata provided by the annotations
(different typecheck decorators have been proposed).
   <!--l. 547-->
<a 
 id="x1-10005r20"></a>
<a 
 id="x1-10006"></a>
<div class="lstlisting" id="listing-23"><span class="label"><a 
 id="x1-10007r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Example</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">for</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">annotations</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">from</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Python</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">3.</span><span 
class="ecrm-0800">x</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10008r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">@typecheck</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">for</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">example</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">from</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ActiveState</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">recipe</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10009r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">@typecheck</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10010r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">hello</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">str</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">age</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">int</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x003E;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">str</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10011r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">Hello</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{0},</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">you</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">are</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{1}</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">years</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">old</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">format</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">age</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10012r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10013r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">hello</span><span 
class="ecrm-0800">(10,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">44)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10014r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10015r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10016r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">Traceback</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">most</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">recent</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">call</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">last</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10017r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">...</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10018r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">TypeError</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">Incorrect</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">type</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">for</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">name</span><span 
class="ecrm-0800">"</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10019r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;20:
    </span><span  
class="content">Type
    check
    with
    function
    annotations</span></div><!--tex4ht:label?: x1-10005r -->
   </div>
<!--l. 563--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-11000"></a><span 
class="ecbx-1000">Conclusion</span></span>
   Python is a flexible and powerful language, allowing the creation of meta
programming structures with a compact and very intuitive syntax. There are several
similarities with Perl&#8217;s Moose and MOP and also with Lisp&#8217;s CLOS. Like in Lisp, in
Python everything is an object, and the language leverages this feature, allowing to
dynamically manipulate the code. Python allows to easily access to meta
programming tasks thanks to its dynamic nature and to builtin meta class structures.
Python lacks the powerful Lisp macros, but it provides other tools like decorators
and AST access.
<!--l. 566--><p class="noindent" >
   <h3 class="likesectionHead"><a 
 id="x1-12000"></a>References</h3>
<!--l. 566--><p class="noindent" >
    <div class="thebibliography">
                                                                  

                                                                  
    <p class="bibitem" ><span class="biblabel">
  [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xtorta_2014"></a>G.  Torta,  Meta-Programming,  PhD  Program  in  Computer  Science,
    UniversitÃ  di Torino, 2014
    </p>
    <p class="bibitem" ><span class="biblabel">
  [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xpython_datamodel"></a>Python                          documentation,                           Python
    Data model, <a 
href="https://docs.python.org/2/reference/datamodel.html" class="url" ><span 
class="ectt-1000">https://docs.python.org/2/reference/datamodel.html</span></a>,
    last access 24.12.2014
    </p>
    <p class="bibitem" ><span class="biblabel">
  [3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xpython_norvig"></a>Peter        Norvig,        Python        for        Lisp        Programmers,
    <a 
href="http://norvig.com/python-lisp.html" class="url" ><span 
class="ectt-1000">http://norvig.com/python-lisp.html</span></a>, last access 24.12.2014
    </p>
    <p class="bibitem" ><span class="biblabel">
  [4]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xpcb_2013"></a>David  Beazley,  Brian  K.  Jones,  Python  Cookbook,  Third  Edition,
    O&#8217;Reilly, 2013
    </p>
    <p class="bibitem" ><span class="biblabel">
  [5]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xpython"></a>Python Language, <a 
href="http://www.python.org" class="url" ><span 
class="ectt-1000">http://www.python.org</span></a>, last access 24.12.2014
    </p>
    <p class="bibitem" ><span class="biblabel">
  [6]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xmacropy"></a>MacroPy,    <a 
href="https://github.com/lihaoyi/macropy" class="url" ><span 
class="ectt-1000">https://github.com/lihaoyi/macropy</span></a>,    last    access
    24.12.2014
    </p>
    <p class="bibitem" ><span class="biblabel">
  [7]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xannotations"></a>PEP                 3107                 Function                 Annotations,
    <a 
href="https://www.python.org/dev/peps/pep-3107/" class="url" ><span 
class="ectt-1000">https://www.python.org/dev/peps/pep-3107/</span></a>, last access 24.12.2014
</p>
    </div>
<!--l. 578--><p class="indent" >
                                                                  
<!--l. 566--><p class="noindent" >
   <h3 class="likesectionHead"><a 
 id="x1-12000"></a>Copyright and Licence</h3>
This article is copyright &copy;  2015 by Paolo Casagranda. Licensed under the <a href="https://creativecommons.org/licenses/by-sa/2.0/">Creative Commons Attribution-ShareAlike license 2.0 <img src="images/ccbysa.png"/></a>.
                                                                   
<!--l. 579--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-13000"></a><span 
class="ecbx-1000">Appendix: additional example on decorators</span></span>
   Decorators are a very powerful tool to modify functions and methods. For this
reason they are used in most of Python web frameworks (e.g. Django, Flask,
Tornado), and we include an additional example.
<!--l. 582--><p class="indent" >   The memoize function, allowing to cache recursive calculations, is an interesting
application. In the following listing we define two meta functions: <span 
class="ectt-1000">@timeit</span>,
calculating the execution time of the decorated function, and <span 
class="ectt-1000">@memoize </span>itself, caching
the values of a target function. The decorators are applied to a simple fibonacci
function.
   <!--l. 584-->
<a 
 id="x1-13001r21"></a>
<a 
 id="x1-13002"></a>
<div class="lstlisting" id="listing-24"><span class="label"><a 
 id="x1-13003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecrm-0800">import</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">time</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">timeit</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">decorator</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">timeit</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">method</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">timed</span><span 
class="ecrm-0800">(</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">**</span><span 
class="ecrm-0800">kw</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">ts</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">time</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">time</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">result</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">method</span><span 
class="ecrm-0800">(</span><span 
class="cmsy-8">*</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">**</span><span 
class="ecrm-0800">kw</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">te</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">time</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">time</span><span 
class="ecrm-0800">()</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13013r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">print</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">r</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(%</span><span 
class="ecrm-0800">r</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">r</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%2.2</span><span 
class="ecrm-0800">f</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">sec</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">%</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">\</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13014r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">method</span><span 
class="ecrm-0800">.</span><span 
class="ecrm-0800">__name__</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">args</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">kw</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">te</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">ts</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13015r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">result</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13016r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13017r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">timed</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13018r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13019r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">memoize</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">decorator</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">creates</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">cache</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">for</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">function</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">values</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13020r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">memoize</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">f</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13021r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">cache</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{}</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13022r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">helper</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">x</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13023r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">if</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">x</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">not</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">in</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">cache</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13024r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">cache</span><span 
class="ecrm-0800">[</span><span 
class="ecrm-0800">x</span><span 
class="ecrm-0800">]</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">=</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">f</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">x</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13025r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">cache</span><span 
class="ecrm-0800">[</span><span 
class="ecrm-0800">x</span><span 
class="ecrm-0800">]</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13026r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">helper</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13027r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13028r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ecrm-0800">@memoize</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13029r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fib</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13030r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">if</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">in</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(0,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">1)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13031r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13032r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">else</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13033r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fib</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">1)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">+</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fib</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">2)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13034r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13035r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fib2</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13036r34"></a><span 
class="ecrm-0500">34</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">if</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">in</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">(0,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">1)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13037r35"></a><span 
class="ecrm-0500">35</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13038r36"></a><span 
class="ecrm-0500">36</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">else</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13039r37"></a><span 
class="ecrm-0500">37</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fib2</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">1)</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">+</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fib2</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmsy-8">-</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">2)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13040r38"></a><span 
class="ecrm-0500">38</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13041r39"></a><span 
class="ecrm-0500">39</span></span><span 
class="ecrm-0800">@timeit</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13042r40"></a><span 
class="ecrm-0500">40</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fibfast</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13043r41"></a><span 
class="ecrm-0500">41</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fib</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13044r42"></a><span 
class="ecrm-0500">42</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13045r43"></a><span 
class="ecrm-0500">43</span></span><span 
class="ecrm-0800">@timeit</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13046r44"></a><span 
class="ecrm-0500">44</span></span><span 
class="ecrm-0800">def</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fibslow</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13047r45"></a><span 
class="ecrm-0500">45</span></span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">return</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">fib2</span><span 
class="ecrm-0800">(</span><span 
class="ecrm-0800">n</span><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13048r46"></a><span 
class="ecrm-0500">46</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13049r47"></a><span 
class="ecrm-0500">47</span></span><span 
class="ecrm-0800">#</span><span 
class="ecrm-0800">fibslow</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">50</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">is</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">too</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">long</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">for</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">a</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">quick</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">test</span><span 
class="ecrm-0800">!</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13050r48"></a><span 
class="ecrm-0500">48</span></span><span 
class="ecrm-0800">fibfast</span><span 
class="ecrm-0800">(40)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13051r49"></a><span 
class="ecrm-0500">49</span></span><span 
class="ecrm-0800">fibslow</span><span 
class="ecrm-0800">(40)</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13052r50"></a><span 
class="ecrm-0500">50</span></span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13053r51"></a><span 
class="ecrm-0500">51</span></span><span 
class="ecrm-0800">"""</span><span 
class="ecrm-0800">Output</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">:</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13054r52"></a><span 
class="ecrm-0500">52</span></span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">fibfast</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">((40,)</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{})</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">0.00</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">sec</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13055r53"></a><span 
class="ecrm-0500">53</span></span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">fibslow</span><span 
class="ecrm-0800">&#8217;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">((40,)</span><span 
class="ecrm-0800">,</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">{})</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">43.40</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">sec</span><span 
class="ecrm-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13056r54"></a><span 
class="ecrm-0500">54</span></span><span 
class="ecrm-0800">"""</span>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;21:
    </span><span  
class="content">Python
    timeit
    and
    memoize
    decorators</span></div><!--tex4ht:label?: x1-13001r -->
   </div>
<!--l. 640--><p class="indent" >   Thanks to the timeit decorator, we understand that using the memoize decorator
the fibonacci function is very fast, even at its first run, thanks to the intermediate
values caching.

</body></html> 

                                                                  


